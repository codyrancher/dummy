{"version":3,"sources":["webpack:///./shell/dialog/AddProjectMemberDialog.vue?3ef7","webpack:///./shell/dialog/AddProjectMemberDialog.vue?f659","webpack:///./shell/dialog/AddProjectMemberDialog.vue?f9e1","webpack:///shell/dialog/AddProjectMemberDialog.vue","webpack:///./shell/dialog/AddProjectMemberDialog.vue?3374","webpack:///./shell/dialog/AddProjectMemberDialog.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","domProps","_s","t","slot","_v","error","_e","model","value","callback","$$v","member","expression","on","close","cb","saveBindings","apply","staticRenderFns","components","Card","ProjectMemberEditor","AsyncButton","Banner","props","resources","type","required","onAdd","default","projectId","saveInModal","data","permissionGroup","custom","principalId","roleTemplateIds","computed","principal","id","opt","url","root","methods","principalProperty","createBindings","promises","roleTemplateId","Promise","btnCB","then","setTimeout","catch","component"],"mappings":"oIAAA,W,2DCAA,W,yCCAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,OAAO,CAACE,YAAY,gBAAgBC,MAAM,CAAC,yBAAwB,EAAM,QAAS,IAAO,CAACH,EAAG,KAAK,CAACE,YAAY,oBAAoBC,MAAM,CAAC,KAAO,SAASC,SAAS,CAAC,UAAYR,EAAIS,GAAGT,EAAIU,EAAE,kCAAkCC,KAAK,UAAUP,EAAG,MAAM,CAACE,YAAY,cAAcC,MAAM,CAAC,KAAO,QAAQI,KAAK,QAAQ,CAAEX,EAAS,MAAEI,EAAG,SAAS,CAACG,MAAM,CAAC,MAAQ,UAAU,CAACP,EAAIY,GAAG,IAAIZ,EAAIS,GAAGT,EAAIa,OAAO,OAAOb,EAAIc,KAAKV,EAAG,sBAAsB,CAACG,MAAM,CAAC,8BAA6B,GAAMQ,MAAM,CAACC,MAAOhB,EAAU,OAAEiB,SAAS,SAAUC,GAAMlB,EAAImB,OAAOD,GAAKE,WAAW,aAAa,GAAGhB,EAAG,MAAM,CAACE,YAAY,UAAUC,MAAM,CAAC,KAAO,WAAWI,KAAK,WAAW,CAACP,EAAG,SAAS,CAACE,YAAY,2BAA2Be,GAAG,CAAC,MAAQrB,EAAIsB,QAAQ,CAACtB,EAAIY,GAAG,IAAIZ,EAAIS,GAAGT,EAAIU,EAAE,mBAAmB,OAAQV,EAAe,YAAEI,EAAG,cAAc,CAACG,MAAM,CAAC,KAAO,UAAUc,GAAG,CAAC,MAAQ,SAAUE,GAAK,OAAOvB,EAAIwB,aAAaD,OAAUnB,EAAG,SAAS,CAACE,YAAY,mBAAmBe,GAAG,CAAC,MAAQrB,EAAIyB,QAAQ,CAACzB,EAAIY,GAAG,IAAIZ,EAAIS,GAAGT,EAAIU,EAAE,gBAAgB,QAAQ,MAC9kCgB,EAAkB,G,qMCMP,GACfC,YACAC,YACAC,2BACAC,mBACAC,eAGAC,OACAC,WACAC,WACAC,aAGAC,OACAF,cACAG,sBAGAC,WACAJ,YACAG,cAGAE,aACAL,aACAG,aAIAG,KA9BA,WA+BA,OACArB,QACAsB,yBACAC,UACAC,eACAC,oBAEA/B,aAIAgC,UACAC,UADA,WAEA,mDAEA,4CACAZ,sBACAa,2BACAC,KAAAC,kCACA,CAAAC,YAIAC,SACAC,kBADA,WACA,gJACA,YADA,cACAN,EADA,yBAGA,8FAHA,8CAMAxB,MAPA,WAQA,qBAGAG,MAXA,WAWA,sIACA,EADA,SACA,mBADA,wBACAW,MADA,gBAEA,UAFA,8CAKAiB,eAhBA,WAgBA,kJACA,sBADA,cACAD,EADA,OAEAE,EAAA,8FACApB,0CACAqB,kBAFA,iBAGAH,EAAA,sBAHA,6BAIA,aAJA,OAFA,kBASAI,gBATA,8CAYAhC,aA5BA,SA4BAiC,GAAA,WACA,gBACA,sBACAC,MAAA,YACA,6DAEAA,MAAA,WACAD,MACAE,2BAEAC,OAAA,YACA,UACAH,YCrG4V,I,kCCSxVI,EAAY,eACd,EACA9D,EACA2B,GACA,EACA,KACA,WACA,MAIa,aAAAmC,E","file":"js/dialog6.aa96f250.js","sourcesContent":["export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../node_modules/@vue/cli-service/node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./AddProjectMemberDialog.vue?vue&type=style&index=1&id=25d6f7bc&prod&lang=scss&\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../node_modules/@vue/cli-service/node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./AddProjectMemberDialog.vue?vue&type=style&index=0&id=25d6f7bc&prod&lang=scss&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('Card',{staticClass:\"prompt-rotate\",attrs:{\"show-highlight-border\":false,\"sticky\":true}},[_c('h4',{staticClass:\"text-default-text\",attrs:{\"slot\":\"title\"},domProps:{\"innerHTML\":_vm._s(_vm.t('addProjectMemberDialog.title'))},slot:\"title\"}),_c('div',{staticClass:\"pl-10 pr-10\",attrs:{\"slot\":\"body\"},slot:\"body\"},[(_vm.error)?_c('Banner',{attrs:{\"color\":\"error\"}},[_vm._v(\" \"+_vm._s(_vm.error)+\" \")]):_vm._e(),_c('ProjectMemberEditor',{attrs:{\"use-two-columns-for-custom\":true},model:{value:(_vm.member),callback:function ($$v) {_vm.member=$$v},expression:\"member\"}})],1),_c('div',{staticClass:\"buttons\",attrs:{\"slot\":\"actions\"},slot:\"actions\"},[_c('button',{staticClass:\"btn role-secondary mr-10\",on:{\"click\":_vm.close}},[_vm._v(\" \"+_vm._s(_vm.t('generic.cancel'))+\" \")]),(_vm.saveInModal)?_c('AsyncButton',{attrs:{\"mode\":\"create\"},on:{\"click\":function (cb){ return _vm.saveBindings(cb); }}}):_c('button',{staticClass:\"btn role-primary\",on:{\"click\":_vm.apply}},[_vm._v(\" \"+_vm._s(_vm.t('generic.add'))+\" \")])],1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<script>\r\nimport { Card } from '@components/Card';\r\nimport ProjectMemberEditor from '@shell/components/form/ProjectMemberEditor';\r\nimport AsyncButton from '@shell/components/AsyncButton';\r\nimport Banner from '@components/Banner/Banner.vue';\r\nimport { NORMAN } from '@shell/config/types';\r\n\r\nexport default {\r\n  components: {\r\n    Card,\r\n    ProjectMemberEditor,\r\n    AsyncButton,\r\n    Banner\r\n  },\r\n\r\n  props: {\r\n    resources: {\r\n      type:     Array,\r\n      required: true\r\n    },\r\n\r\n    onAdd: {\r\n      type:    Function,\r\n      default: () => {}\r\n    },\r\n\r\n    projectId: {\r\n      type:    String,\r\n      default: null\r\n    },\r\n\r\n    saveInModal: {\r\n      type:    Boolean,\r\n      default: false\r\n    }\r\n  },\r\n\r\n  data() {\r\n    return {\r\n      member: {\r\n        permissionGroup: 'member',\r\n        custom:          {},\r\n        principalId:     '',\r\n        roleTemplateIds: []\r\n      },\r\n      error: null\r\n    };\r\n  },\r\n\r\n  computed: {\r\n    principal() {\r\n      const principalId = this.member.principalId.replace(/\\//g, '%2F');\r\n\r\n      return this.$store.dispatch('rancher/find', {\r\n        type: NORMAN.PRINCIPAL,\r\n        id:   this.member.principalId,\r\n        opt:  { url: `/v3/principals/${ principalId }` }\r\n      }, { root: true });\r\n    },\r\n  },\r\n\r\n  methods: {\r\n    async principalProperty() {\r\n      const principal = await this.principal;\r\n\r\n      return principal?.principalType === 'group' ? 'groupPrincipalId' : 'userPrincipalId';\r\n    },\r\n\r\n    close() {\r\n      this.$emit('close');\r\n    },\r\n\r\n    async apply() {\r\n      this.onAdd(await this.createBindings());\r\n      this.close();\r\n    },\r\n\r\n    async createBindings() {\r\n      const principalProperty = await this.principalProperty();\r\n      const promises = this.member.roleTemplateIds.map(roleTemplateId => this.$store.dispatch(`rancher/create`, {\r\n        type:                NORMAN.PROJECT_ROLE_TEMPLATE_BINDING,\r\n        roleTemplateId,\r\n        [principalProperty]: this.member.principalId,\r\n        projectId:           this.projectId,\r\n      }));\r\n\r\n      return Promise.all(promises);\r\n    },\r\n\r\n    saveBindings(btnCB) {\r\n      this.error = null;\r\n      this.createBindings()\r\n        .then((bindings) => {\r\n          return Promise.all(bindings.map(b => b.save()));\r\n        })\r\n        .then(() => {\r\n          btnCB(true);\r\n          setTimeout(this.close, 500);\r\n        })\r\n        .catch((err) => {\r\n          this.error = err;\r\n          btnCB(false);\r\n        });\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<template>\r\n  <Card\r\n    class=\"prompt-rotate\"\r\n    :show-highlight-border=\"false\"\r\n    :sticky=\"true\"\r\n  >\r\n    <h4\r\n      slot=\"title\"\r\n      class=\"text-default-text\"\r\n      v-html=\"t('addProjectMemberDialog.title')\"\r\n    />\r\n\r\n    <div\r\n      slot=\"body\"\r\n      class=\"pl-10 pr-10\"\r\n    >\r\n      <Banner\r\n        v-if=\"error\"\r\n        color=\"error\"\r\n      >\r\n        {{ error }}\r\n      </Banner>\r\n      <ProjectMemberEditor\r\n        v-model=\"member\"\r\n        :use-two-columns-for-custom=\"true\"\r\n      />\r\n    </div>\r\n\r\n    <div\r\n      slot=\"actions\"\r\n      class=\"buttons\"\r\n    >\r\n      <button\r\n        class=\"btn role-secondary mr-10\"\r\n        @click=\"close\"\r\n      >\r\n        {{ t('generic.cancel') }}\r\n      </button>\r\n\r\n      <AsyncButton\r\n        v-if=\"saveInModal\"\r\n        mode=\"create\"\r\n        @click=\"cb=>saveBindings(cb)\"\r\n      />\r\n\r\n      <button\r\n        v-else\r\n        class=\"btn role-primary\"\r\n        @click=\"apply\"\r\n      >\r\n        {{ t('generic.add') }}\r\n      </button>\r\n    </div>\r\n  </Card>\r\n</template>\r\n<style lang='scss' scoped>\r\n  .prompt-rotate {\r\n    margin: 0;\r\n  }\r\n  .buttons {\r\n    display: flex;\r\n    justify-content: flex-end;\r\n    width: 100%;\r\n  }\r\n</style>\r\n\r\n<style lang=\"scss\">\r\n  .card-container {\r\n    border: 1px solid var(--border);\r\n    box-shadow: none;\r\n  }\r\n</style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--16-0!../../node_modules/babel-loader/lib/index.js??ref--16-1!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./AddProjectMemberDialog.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--16-0!../../node_modules/babel-loader/lib/index.js??ref--16-1!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./AddProjectMemberDialog.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./AddProjectMemberDialog.vue?vue&type=template&id=25d6f7bc&scoped=true&\"\nimport script from \"./AddProjectMemberDialog.vue?vue&type=script&lang=js&\"\nexport * from \"./AddProjectMemberDialog.vue?vue&type=script&lang=js&\"\nimport style0 from \"./AddProjectMemberDialog.vue?vue&type=style&index=0&id=25d6f7bc&prod&lang=scss&scoped=true&\"\nimport style1 from \"./AddProjectMemberDialog.vue?vue&type=style&index=1&id=25d6f7bc&prod&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"25d6f7bc\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}