(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages/c/_cluster/apps/charts/install"],{"0f25":function(e,t,a){"use strict";a("66f8")},2467:function(e,t,a){"use strict";a("1d8f"),a("13ec"),a("7e5b"),a("bcff"),a("46d9"),a("a41c"),a("d323"),a("2869"),a("a797"),a("5986");var s=a("1da1"),n=a("ade3"),r=a("a34a"),i=a.n(r),o=(a("96cf"),a("8be0"),a("38aa"),a("b61e"),a("9d9d"),a("cf99"),a("b667"),a("59d0"),a("0b7a"),a("2b77"),a("2f62")),l=a("fa3b"),c=a("7388"),u=a("e528"),p=a("98bd"),d=a("5bbf"),h=a("04e8"),m=a("a788"),v=a("55a3"),f=a("ceac"),g=a.n(f),b=a("5ce5");function y(e,t){var a="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=w(e))||t&&e&&"number"===typeof e.length){a&&(e=a);var s=0,n=function(){};return{s:n,n:function(){return s>=e.length?{done:!0}:{done:!1,value:e[s++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i=!0,o=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return i=e.done,e},e:function(e){o=!0,r=e},f:function(){try{i||null==a.return||a.return()}finally{if(o)throw r}}}}function w(e,t){if(e){if("string"===typeof e)return O(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?O(e,t):void 0}}function O(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,s=new Array(t);a<t;a++)s[a]=e[a];return s}function C(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function x(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?C(Object(a),!0).forEach((function(t){Object(n["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):C(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}t["a"]={data:function(){return{version:null,versionInfo:null,existing:null,ignoreWarning:!1}},computed:x(x({},Object(o["b"])(["currentCluster","isRancher"])),{},{showPreRelease:Object(u["mapPref"])(u["SHOW_PRE_RELEASE"]),chart:function(){return this.repo&&this.query.chartName?this.$store.getters["catalog/chart"]({repoType:this.query.repoType,repoName:this.query.repoName,chartName:this.query.chartName,includeHidden:!0}):null},repo:function(){return this.$store.getters["catalog/repo"]({repoType:this.query.repoType,repoName:this.query.repoName})},showReadme:function(){var e;return!(null===(e=this.versionInfo)||void 0===e||!e.readme)},hasReadme:function(){var e,t;return!(null===(e=this.versionInfo)||void 0===e||!e.appReadme)||!(null===(t=this.versionInfo)||void 0===t||!t.readme)},mappedVersions:function(){var e,t,a=this,s=(null===(e=this.chart)||void 0===e?void 0:e.versions)||[],n=this.targetVersion,r=null===(t=this.currentCluster)||void 0===t?void 0:t.workerOSs,i=[];s.forEach((function(e){var t,s={label:e.version,version:e.version,originalVersion:e.version,shortLabel:e.version.length>16?"".concat(e.version.slice(0,15),"..."):e.version,id:e.version,created:e.created,disabled:!1,keywords:e.keywords},n=((null===e||void 0===e||null===(t=e.annotations)||void 0===t?void 0:t[c["e"].PERMITTED_OS])||b["LINUX"]).split(",");n.length>0&&g()(r,n).length>0&&(s.disabled=!0),1===n.length&&(s.label=a.t("catalog.install.versions.".concat(n[0]),{ver:e.version})),!a.showPreRelease&&Object(v["d"])(e.version)||i.push(s)}));var o=i.find((function(e){return e.id===n}));o||i.unshift({label:n,originalVersion:n,shortLabel:n.length>16?"".concat(n.slice(0,15),"..."):n,id:n,created:null,disabled:!1,keywords:[]});var l=i.find((function(e){return e.originalVersion===a.currentVersion}));return l&&(l.label=this.t("catalog.install.versions.current",{ver:this.currentVersion})),i},filteredVersions:function(){return this.showPreRelease?this.mappedVersions:this.mappedVersions.filter((function(e){return!e.isPre}))},query:function(){var e=this.$route.query;return{repoType:e[l["z"]],repoName:e[l["y"]],chartName:e[l["d"]],versionName:e[l["G"]],appNamespace:e[l["u"]]||"",appName:e[l["t"]]||"",description:e[l["g"]]}},showDeprecated:function(){return this.$route.query[l["f"]]===l["M"]},showHidden:function(){return this.$route.query[l["o"]]===l["M"]},warnings:function(){var e=[];if(this.existing);else{var t,a,s,n,r,i,o=Object(h["g"])((null===(t=this.version)||void 0===t||null===(a=t.annotations)||void 0===a?void 0:a[c["e"].REQUESTS_CPU])||"0"),l=Object(h["g"])((null===(s=this.version)||void 0===s||null===(n=s.annotations)||void 0===n?void 0:n[c["e"].REQUESTS_MEMORY])||"0"),u=null===(r=this.currentCluster)||void 0===r?void 0:r.availableCpu,p=null===(i=this.currentCluster)||void 0===i?void 0:i.availableMemory;null!==u&&u<o&&e.push(this.t("catalog.install.error.insufficientCpu",{need:Math.round(100*o)/100,have:Math.round(100*u)/100})),null!==p&&p<l&&e.push(this.t("catalog.install.error.insufficientMemory",{need:Object(h["f"])(l,{increment:1024,suffix:"iB",firstSuffix:"B"}),have:Object(h["f"])(p,{increment:1024,suffix:"iB",firstSuffix:"B"})}))}return e},requires:function(){var e,t,a=[],s=((null===(e=this.version)||void 0===e||null===(t=e.annotations)||void 0===t?void 0:t[c["e"].REQUIRES_GVK])||"").split(/\s*,\s*/).filter((function(e){return!!e})).reverse();if(s.length){var n,r=y(s);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(!this.$store.getters["catalog/isInstalled"]({gvr:i})){var o=this.provider(i);if(o){var l=this.$router.resolve(this.chartLocation(!0,o)).href;a.push(this.t("catalog.install.error.requiresFound",{url:l,name:o.name},!0))}else a.push(this.t("catalog.install.error.requiresMissing",{name:i}))}}}catch(u){r.e(u)}finally{r.f()}}return a},currentVersion:function(){var e;return null===(e=this.existing)||void 0===e?void 0:e.spec.chart.metadata.version},targetVersion:function(){return this.version?this.version.version:this.query.versionName},action:function(){return this.existing?this.currentVersion===this.targetVersion?"update":"upgrade":"install"},isChartTargeted:function(){var e,t;return(null===(e=this.chart)||void 0===e?void 0:e.targetNamespace)&&(null===(t=this.chart)||void 0===t?void 0:t.targetName)},hasQuestions:function(){return this.versionInfo&&!!this.versionInfo.questions}}),methods:{fetchChart:function(){var e=this;return Object(s["a"])(i.a.mark((function t(){var a,s,n;return i.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("catalog/load",{force:!0,reset:!0});case 2:if(!e.query.appNamespace||!e.query.appName){t.next=16;break}return t.prev=3,t.next=6,e.$store.dispatch("cluster/find",{type:m["f"].APP,id:"".concat(e.query.appNamespace,"/").concat(e.query.appName)});case 6:e.existing=t.sent,e.mode=l["L"],t.next=14;break;case 10:t.prev=10,t.t0=t["catch"](3),e.mode=l["J"],e.existing=null;case 14:t.next=31;break;case 16:if(null===(a=e.chart)||void 0===a||!a.targetNamespace||null===(s=e.chart)||void 0===s||!s.targetName){t.next=30;break}return t.prev=17,t.next=20,e.$store.dispatch("cluster/find",{type:m["f"].APP,id:"".concat(e.chart.targetNamespace,"/").concat(e.chart.targetName)});case 20:e.existing=t.sent,e.mode=l["L"],t.next=28;break;case 24:t.prev=24,t.t1=t["catch"](17),e.mode=l["J"],e.existing=null;case 28:t.next=31;break;case 30:e.mode=l["J"];case 31:if(e.chart){t.next=33;break}return t.abrupt("return");case 33:if(!e.query.versionName&&null!==(n=e.chart.versions)&&void 0!==n&&n.length&&(e.query.versionName=e.chart.versions[0].version),e.query.versionName){t.next=36;break}return t.abrupt("return");case 36:try{e.version=e.$store.getters["catalog/version"]({repoType:e.query.repoType,repoName:e.query.repoName,chartName:e.query.chartName,versionName:e.query.versionName})}catch(r){console.error("Unable to fetch Version: ",r)}return e.version||console.warn("No version found: ",e.query.repoType,e.query.repoName,e.query.chartName,e.query.versionName),t.prev=38,t.next=41,e.$store.dispatch("catalog/getVersionInfo",{repoType:e.query.repoType,repoName:e.query.repoName,chartName:e.query.chartName,versionName:e.query.versionName});case 41:e.versionInfo=t.sent,t.next=47;break;case 44:t.prev=44,t.t2=t["catch"](38),console.error("Unable to fetch VersionInfo: ",t.t2);case 47:case"end":return t.stop()}}),t,null,[[3,10],[17,24],[38,44]])})))()},selectVersion:function(e){var t=e.id;this.$router.applyQuery(Object(n["a"])({},l["G"],t))},provider:function(e){return this.$store.getters["catalog/versionProviding"]({gvr:e,repoName:this.chart.repoName,repoType:this.chart.repoType})},chartLocation:function(){var e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],a=arguments.length>1?arguments[1]:void 0,s=a||{repoType:this.chart.repoType,repoName:this.chart.repoName,name:this.chart.chartName,version:this.chart.versionName};return{name:t?"c-cluster-apps-charts-install":"c-cluster-apps-charts-chart",params:{cluster:this.$route.params.cluster,product:this.$store.getters["productId"]},query:(e={},Object(n["a"])(e,l["z"],s.repoType),Object(n["a"])(e,l["y"],s.repoName),Object(n["a"])(e,l["d"],s.name),Object(n["a"])(e,l["G"],s.version),e)}},appLocation:function(){var e;return(null===(e=this.existing)||void 0===e?void 0:e.detailLocation)||{name:"c-cluster-product-resource",params:{product:this.$store.getters["productId"],cluster:this.$store.getters["clusterId"],resource:m["f"].APP}}},clusterToolsLocation:function(){return{name:"c-cluster-explorer-tools",params:{product:p["NAME"],cluster:this.$store.getters["clusterId"],resource:m["f"].APP}}},clustersLocation:function(){return{name:"c-cluster-product-resource",params:{cluster:this.$route.params.cluster,product:d["NAME"],resource:m["e"].RANCHER_CLUSTER}}}}}},"3ca4":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.$fetchState.pending?a("Loading"):e.legacyApp||e.mcapp?a("div",{staticClass:"install-steps",class:{isPlainLayout:e.isPlainLayout}},[a("div",{staticClass:"outer-container"},[a("div",{staticClass:"header mb-20"},[a("div",{staticClass:"title"},[a("div",{staticClass:"top choice-banner"},[a("div",{staticClass:"title"},[e._t("bannerTitleImage",(function(){return[a("div",{staticClass:"round-image"},[a("LazyImage",{staticClass:"logo",attrs:{src:e.chart?e.chart.icon:""}})],1)]})),a("div",{staticClass:"subtitle"},[e.stepperName?a("h2",[e._v(" "+e._s(e.stepperName)+" ")]):e._e(),e.stepperSubtext?a("span",{staticClass:"subtext"},[e._v(e._s(e.stepperSubtext))]):e._e()])],2)])])]),a("Banner",{staticClass:"description",attrs:{color:"warning"}},[e.mcapp?e._e():a("span",[e._v(" "+e._s(e.t("catalog.install.error.legacy.label",{legacyType:e.mcapp?e.legacyDefs.mcm:e.legacyDefs.legacy},!0))+" ")]),e.legacyEnabled?e.mcapp?[a("span",{domProps:{innerHTML:e._s(e.t("catalog.install.error.legacy.mcmNotSupported"))}})]:[a("nuxt-link",{attrs:{to:e.legacyAppRoute}},[a("span",{domProps:{innerHTML:e._s(e.t("catalog.install.error.legacy.navigate"))}})])]:[a("span",{domProps:{innerHTML:e._s(e.t("catalog.install.error.legacy.enableLegacy.prompt",!0))}}),a("nuxt-link",{attrs:{to:e.legacyFeatureRoute}},[e._v(" "+e._s(e.t("catalog.install.error.legacy.enableLegacy.goto"))+" ")])]],2)],1)]):a("div",{staticClass:"install-steps",class:{isPlainLayout:e.isPlainLayout}},[a("TypeDescription",{attrs:{resource:"chart"}}),e.value?a("Wizard",{staticClass:"wizard",attrs:{steps:e.steps,errors:e.errors,"edit-first-step":!0,"banner-title":e.stepperName,"banner-title-subtext":e.stepperSubtext,"finish-mode":e.action},on:{cancel:e.cancel,finish:e.finish},scopedSlots:e._u([e._l(e.customSteps,(function(t){return{key:t.name,fn:function(){return[a(t.component,{key:t.name,tag:"component",on:{update:function(a){return e.updateStep(t.name,a)},errors:function(t){return e.errors.push.apply(e.errors,t)}}})]},proxy:!0}})),{key:"bannerTitleImage",fn:function(){return[a("div",[a("div",{staticClass:"logo-bg"},[a("LazyImage",{staticClass:"logo",attrs:{src:e.chart?e.chart.icon:""}})],1),e.windowsIncompatible?a("label",{staticClass:"os-label"},[e._v(" "+e._s(e.windowsIncompatible)+" ")]):e._e()])]},proxy:!0},{key:"basics",fn:function(){return[a("div",{staticClass:"step__basic"},[e.step1Description?a("Banner",{staticClass:"description",attrs:{color:"info"}},[a("div",[a("span",[e._v(e._s(e.step1Description))]),e.namespaceNewAllowed?a("span",{staticClass:"mt-10"},[e._v(" "+e._s(e.t("catalog.install.steps.basics.nsCreationDescription",{},!0))+" ")]):e._e()])]):e._e(),e.requires.length||e.warnings.length?a("div",{staticClass:"mb-15"},[e._l(e.requires,(function(t){return a("Banner",{key:t,attrs:{color:"error"}},[a("span",{domProps:{innerHTML:e._s(t)}})])})),e._l(e.warnings,(function(t){return a("Banner",{key:t,attrs:{color:"warning"}},[a("span",{domProps:{innerHTML:e._s(t)}})])}))],2):e._e(),e.showSelectVersionOrChart?a("div",{staticClass:"row mb-20"},[a("div",{staticClass:"col span-4"},[e.chart?a("LabeledSelect",{attrs:{label:e.t("catalog.install.version"),value:e.query.versionName,options:e.filteredVersions,selectable:function(e){return!e.disabled}},on:{input:e.selectVersion}}):a("LabeledSelect",{attrs:{label:e.t("catalog.install.chart"),value:e.chart,options:e.charts,selectable:function(e){return!e.disabled},"get-option-label":function(t){return e.getOptionLabel(t)},"option-key":"key"},on:{input:function(t){return e.selectChart(t)}},scopedSlots:e._u([{key:"option",fn:function(t){return["divider"===t.kind?[a("hr")]:"label"===t.kind?[a("b",{staticStyle:{position:"relative",left:"-2.5px"}},[e._v(e._s(t.label))])]:e._e()]}}],null,!1,3217780982)})],1)]):e._e(),a("NameNsDescription",{attrs:{"description-hidden":!0,mode:e.mode,"name-disabled":e.nameDisabled,"name-required":!1,"name-ns-hidden":!e.showNameEditor,"force-namespace":e.forceNamespace,"namespace-new-allowed":e.namespaceNewAllowed,"extra-columns":e.showProject?["project"]:[],"show-spacer":!1,horizontal:!1},on:{isNamespaceNew:function(t){e.isNamespaceNew=t}},scopedSlots:e._u([e.showProject?{key:"project",fn:function(){return[a("LabeledSelect",{attrs:{disabled:!e.namespaceIsNew,label:e.t("catalog.install.project"),"option-key":"id",options:e.projectOpts,tooltip:e.namespaceIsNew?"":e.t("catalog.install.namespaceIsInProject",{namespace:e.value.metadata.namespace},!0),"hover-tooltip":!e.namespaceIsNew,status:"info"},model:{value:e.project,callback:function(t){e.project=t},expression:"project"}})]},proxy:!0}:null],null,!0),model:{value:e.value,callback:function(t){e.value=t},expression:"value"}}),a("Checkbox",{staticClass:"mb-20",attrs:{label:e.t("catalog.install.steps.helmCli.checkbox",{action:e.action,existing:!!e.existing})},model:{value:e.showCommandStep,callback:function(t){e.showCommandStep=t},expression:"showCommandStep"}}),e.showCustomRegistry?a("Checkbox",{staticClass:"mb-20",attrs:{label:e.t("catalog.chart.registry.custom.checkBoxLabel"),tooltip:e.t("catalog.chart.registry.tooltip")},model:{value:e.showCustomRegistryInput,callback:function(t){e.showCustomRegistryInput=t},expression:"showCustomRegistryInput"}}):e._e(),a("div",{staticClass:"row"},[a("div",{staticClass:"col span-6"},[e.showCustomRegistryInput?a("LabeledInput",{attrs:{"label-key":"catalog.chart.registry.custom.inputLabel","placeholder-key":"catalog.chart.registry.custom.placeholder","min-height":30},model:{value:e.customRegistrySetting,callback:function(t){e.customRegistrySetting=t},expression:"customRegistrySetting"}}):e._e()],1)]),a("div",{staticClass:"step__values__controls--spacer",staticStyle:{flex:"1"}},[e._v("   ")]),e.isNamespaceNew&&e.value.metadata.namespace.length?a("Banner",{attrs:{color:"info"}},[a("div",{domProps:{innerHTML:e._s(e.t("catalog.install.steps.basics.createNamespace",{namespace:e.value.metadata.namespace},!0))}})]):e._e()],1)]},proxy:!0},{key:"clusterTplVersion",fn:function(){return[a("Banner",{staticClass:"description",attrs:{color:"info"}},[e._v(" "+e._s(e.t("catalog.install.steps.clusterTplVersion.description"))+" ")]),a("div",{staticClass:"row mb-20"},[a("div",{staticClass:"col span-4"},[e.chart?a("LabeledSelect",{attrs:{label:e.t("catalog.install.version"),value:e.query.versionName,options:e.filteredVersions,selectable:function(e){return!e.disabled}},on:{input:e.selectVersion}}):e._e()],1),a("div",{staticClass:"step__values__controls--spacer"},[e._v("   ")]),a("div",{staticClass:"btn-group"},[a("button",{staticClass:"btn bg-primary btn-sm",attrs:{type:"button",disabled:!e.hasReadme||e.showingReadmeWindow},on:{click:function(t){e.showSlideIn=!e.showSlideIn}}},[e._v(" "+e._s(e.t("catalog.install.steps.helmValues.chartInfo.button"))+" ")])])])]},proxy:!0},{key:"helmValues",fn:function(){return[e.step2Description?a("Banner",{staticClass:"description",attrs:{color:"info"}},[e._v(" "+e._s(e.step2Description)+" ")]):e._e(),a("div",{staticClass:"step__values__controls"},[a("ButtonGroup",{attrs:{options:e.formYamlOptions,"inactive-class":"bg-disabled btn-sm","active-class":"bg-primary btn-sm",disabled:e.preFormYamlOption!=e.formYamlOption},model:{value:e.preFormYamlOption,callback:function(t){e.preFormYamlOption=t},expression:"preFormYamlOption"}}),a("div",{staticClass:"step__values__controls--spacer"},[e._v("   ")]),e.showDiff?a("ButtonGroup",{attrs:{options:e.yamlDiffModeOptions,"inactive-class":"bg-disabled btn-sm","active-class":"bg-primary btn-sm"},model:{value:e.diffMode,callback:function(t){e.diffMode=t},expression:"diffMode"}}):e._e(),e.hasReadme&&!e.showingReadmeWindow?a("div",{staticClass:"btn-group"},[a("button",{staticClass:"btn bg-primary btn-sm",attrs:{type:"button"},on:{click:function(t){e.showSlideIn=!e.showSlideIn}}},[e._v(" "+e._s(e.t("catalog.install.steps.helmValues.chartInfo.button"))+" ")])]):e._e()],1),a("div",{staticClass:"scroll__container"},[a("div",{staticClass:"scroll__content"},[e.valuesComponent&&e.showValuesComponent?[e.componentHasTabs?a("Tabbed",{ref:"tabs",staticClass:"step__values__content",class:{"with-name":e.showNameEditor},attrs:{"side-tabs":!0},on:{changed:function(t){return e.tabChanged(t)}}},[a(e.valuesComponent,{tag:"component",staticClass:"step__values__content",attrs:{mode:e.mode,chart:e.chart,existing:e.existing,version:e.version,"version-info":e.versionInfo},on:{warn:function(t){return e.errors.push(t)},"register-before-hook":e.registerBeforeHook,"register-after-hook":e.registerAfterHook},model:{value:e.chartValues,callback:function(t){e.chartValues=t},expression:"chartValues"}})],1):[e.valuesComponent?a(e.valuesComponent,{tag:"component",staticClass:"step__values__content",attrs:{mode:e.mode,chart:e.chart,existing:e.existing,version:e.version,"version-info":e.versionInfo},on:{warn:function(t){return e.errors.push(t)},"register-before-hook":e.registerBeforeHook,"register-after-hook":e.registerAfterHook},model:{value:e.chartValues,callback:function(t){e.chartValues=t},expression:"chartValues"}}):e._e()]]:e.hasQuestions&&e.showQuestions?a("Tabbed",{ref:"tabs",staticClass:"step__values__content",class:{"with-name":e.showNameEditor},attrs:{"side-tabs":!0},on:{changed:function(t){return e.tabChanged(t)}}},[a("Questions",{attrs:{"in-store":e.inStore,mode:e.mode,source:e.versionInfo,tabbed:"multiple","target-namespace":e.targetNamespace},model:{value:e.chartValues,callback:function(t){e.chartValues=t},expression:"chartValues"}})],1):[a("YamlEditor",{ref:"yaml",staticClass:"step__values__content",attrs:{scrolling:!0,"initial-yaml-values":e.originalYamlValues,"editor-mode":e.editorMode,"hide-preview-buttons":!0},model:{value:e.valuesYaml,callback:function(t){e.valuesYaml=t},expression:"valuesYaml"}})]],2)]),a("ResourceCancelModal",{ref:"cancelModal",attrs:{"is-cancel-modal":!1,"is-form":!0},on:{"cancel-cancel":function(t){e.preFormYamlOption=e.formYamlOption},"confirm-cancel":function(t){e.formYamlOption=e.preFormYamlOption}}})]},proxy:!0},{key:"helmCli",fn:function(){return[e.step3Description?a("Banner",{staticClass:"description",attrs:{color:"info"}},[e._v(" "+e._s(e.step3Description)+" ")]):e._e(),a("div",[e.existing?a("Checkbox",{attrs:{label:e.t("catalog.install.helm.cleanupOnFail")},model:{value:e.customCmdOpts.cleanupOnFail,callback:function(t){e.$set(e.customCmdOpts,"cleanupOnFail",t)},expression:"customCmdOpts.cleanupOnFail"}}):e._e()],1),a("div",[e.existing?e._e():a("Checkbox",{attrs:{label:e.t("catalog.install.helm.crds")},model:{value:e.customCmdOpts.crds,callback:function(t){e.$set(e.customCmdOpts,"crds",t)},expression:"customCmdOpts.crds"}})],1),a("div",[a("Checkbox",{attrs:{label:e.t("catalog.install.helm.hooks")},model:{value:e.customCmdOpts.hooks,callback:function(t){e.$set(e.customCmdOpts,"hooks",t)},expression:"customCmdOpts.hooks"}})],1),a("div",[e.existing?a("Checkbox",{attrs:{label:e.t("catalog.install.helm.force")},model:{value:e.customCmdOpts.force,callback:function(t){e.$set(e.customCmdOpts,"force",t)},expression:"customCmdOpts.force"}}):e._e()],1),a("div",[e.existing?a("Checkbox",{attrs:{label:e.t("catalog.install.helm.resetValues")},model:{value:e.customCmdOpts.resetValues,callback:function(t){e.$set(e.customCmdOpts,"resetValues",t)},expression:"customCmdOpts.resetValues"}}):e._e()],1),a("div",[e.existing?e._e():a("Checkbox",{attrs:{label:e.t("catalog.install.helm.openapi")},model:{value:e.customCmdOpts.openApi,callback:function(t){e.$set(e.customCmdOpts,"openApi",t)},expression:"customCmdOpts.openApi"}})],1),a("div",[a("Checkbox",{attrs:{label:e.t("catalog.install.helm.wait")},model:{value:e.customCmdOpts.wait,callback:function(t){e.$set(e.customCmdOpts,"wait",t)},expression:"customCmdOpts.wait"}})],1),a("div",{staticClass:"mt-10",staticStyle:{display:"block","max-width":"400px"}},[a("UnitInput",{attrs:{label:e.t("catalog.install.helm.timeout.label"),suffix:e.t("catalog.install.helm.timeout.unit",{value:e.customCmdOpts.timeout})},model:{value:e.customCmdOpts.timeout,callback:function(t){e.$set(e.customCmdOpts,"timeout",e._n(t))},expression:"customCmdOpts.timeout"}})],1),a("div",{staticClass:"mt-10",staticStyle:{display:"block","max-width":"400px"}},[e.existing?a("UnitInput",{attrs:{label:e.t("catalog.install.helm.historyMax.label"),suffix:e.t("catalog.install.helm.historyMax.unit",{value:e.customCmdOpts.historyMax})},model:{value:e.customCmdOpts.historyMax,callback:function(t){e.$set(e.customCmdOpts,"historyMax",e._n(t))},expression:"customCmdOpts.historyMax"}}):e._e()],1),a("div",{staticClass:"mt-10",staticStyle:{display:"block","max-width":"400px"}},[a("LabeledInput",{attrs:{"label-key":"catalog.install.helm.description.label","placeholder-key":"catalog.install.helm.description.placeholder","min-height":30},model:{value:e.customCmdOpts.description,callback:function(t){e.$set(e.customCmdOpts,"description",t)},expression:"customCmdOpts.description"}})],1)]},proxy:!0}],null,!0)}):e._e(),a("div",{staticClass:"slideIn",class:{hide:!1,slideIn__show:e.showSlideIn}},[a("h2",{staticClass:"slideIn__header"},[e._v(" "+e._s(e.t("catalog.install.steps.helmValues.chartInfo.label"))+" "),a("div",{staticClass:"slideIn__header__buttons"},[a("div",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.t("catalog.install.slideIn.dock"),expression:"t('catalog.install.slideIn.dock')"}],staticClass:"slideIn__header__button",on:{click:function(t){e.showSlideIn=!1,e.showReadmeWindow()}}},[a("i",{staticClass:"icon icon-dock"})]),a("div",{staticClass:"slideIn__header__button",on:{click:function(t){e.showSlideIn=!1}}},[a("i",{staticClass:"icon icon-close"})])])]),e.hasReadme?a("ChartReadme",{staticClass:"chart-content__tabs",attrs:{"version-info":e.versionInfo}}):e._e()],1)],1)},n=[],r=(a("7e5b"),a("bcff"),a("b61e"),a("46d9"),a("2869"),a("2909")),i=a("ade3"),o=a("1da1"),l=a("a34a"),c=a.n(l),u=(a("96cf"),a("9ce4"),a("6d55"),a("1d8f"),a("0b7a"),a("13ec"),a("d323"),a("b667"),a("ddc0"),a("a797"),a("8be0"),a("5986"),a("bb4d"),a("cf99"),a("2b77"),a("9d9d"),a("e89d"),a("38aa"),a("e673"),a("a41c"),a("59d0"),a("a14a")),p=a("4245"),d=a.n(p),h=a("63ea"),m=a.n(h),v=a("e528"),f=a("c2de"),g=a("2f62"),b=a("bec1"),y=a("5557"),w=a("5fc0"),O=a("4de2"),C=a("a95f"),x=a("84d3"),N=a("669c"),_=a("bc1c"),k=a("c778"),V=a("fe5a"),S=a("4360"),R=a("19c1"),I=a("a4d2"),j=a("1599"),T=a("8366"),P=a("8f23"),$=a("35f4"),D=a("2467"),E=a("ad3d"),L=a("a788"),M=a("fa3b"),Y=a("7388"),A=a("4579"),q=a("de78"),F=a("f303"),U=a("2b0e"),H=a("f29a"),W=a("5ce5");function B(e,t){var a="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=G(e))||t&&e&&"number"===typeof e.length){a&&(e=a);var s=0,n=function(){};return{s:n,n:function(){return s>=e.length?{done:!0}:{done:!1,value:e[s++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i=!0,o=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return i=e.done,e},e:function(e){o=!0,r=e},f:function(){try{i||null==a.return||a.return()}finally{if(o)throw r}}}}function G(e,t){if(e){if("string"===typeof e)return K(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?K(e,t):void 0}}function K(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,s=new Array(t);a<t;a++)s[a]=e[a];return s}function Q(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function z(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(a),!0).forEach((function(t){Object(i["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Q(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var J={FORM:"FORM",YAML:"YAML",DIFF:"DIFF"};function X(e){return Object.keys(e).includes(M["p"])}var Z={name:"Install",layout:function(e){return X(e.query)?"plain":""},components:{Banner:b["a"],ButtonGroup:y["a"],ChartReadme:w["a"],Checkbox:O["a"],LabeledInput:x["a"],LabeledSelect:C["a"],LabeledTooltip:N["a"],LazyImage:_["a"],Loading:k["a"],NameNsDescription:V["a"],ResourceCancelModal:S["a"],Questions:R["a"],Tabbed:I["a"],UnitInput:j["a"],YamlEditor:T["b"],Wizard:P["a"],TypeDescription:$["a"]},mixins:[E["c"],D["a"]],fetch:function(){var e=this;return Object(o["a"])(c.a.mark((function t(){var a,s,n,r,i,o,l,u,p,h,m,v,f,g,b,y,w,O,C,x,N,_,k,V,S,R,I,j;return c.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.fetchChart();case 2:if(e.errors=[],!e.showCustomRegistry){t.next=11;break}return t.next=6,e.getClusterRegistry();case 6:return e.clusterRegistry=t.sent,t.next=9,e.getGlobalRegistry();case 9:e.globalRegistry=t.sent,e.defaultRegistrySetting=e.clusterRegistry||e.globalRegistry;case 11:return t.next=13,e.$store.dispatch("management/find",{type:L["x"].SETTING,id:"server-url"});case 13:if(e.serverUrlSetting=t.sent,e.existing?(e.forceNamespace=e.existing.metadata.namespace,e.nameDisabled=!0):e.$route.query[M["i"]]===M["M"]?e.forceNamespace=L["k"]:null!==(a=e.chart)&&void 0!==a&&a.targetNamespace?e.forceNamespace=e.chart.targetNamespace:e.query.appNamespace?e.forceNamespace=e.query.appNamespace:e.forceNamespace=null,!e.existing){t.next=21;break}return t.next=18,e.existing.deployedAsLegacy();case 18:t.t0=t.sent,t.next=22;break;case 21:t.t0=!1;case 22:if(e.legacyApp=t.t0,!e.existing){t.next=29;break}return t.next=26,e.existing.deployedAsMultiCluster();case 26:t.t1=t.sent,t.next=30;break;case 29:t.t1=!1;case 30:return e.mcapp=t.t1,t.next=33,e.$store.dispatch("cluster/create",{type:"chartInstallAction",metadata:{namespace:e.forceNamespace||e.$store.getters["defaultNamespace"],name:(null===(s=e.existing)||void 0===s||null===(n=s.spec)||void 0===n?void 0:n.name)||e.query.appName||""}});case 33:if(e.value=t.sent,e.existing||(null!==(p=e.chart)&&void 0!==p&&p.targetName?(e.value.metadata.name=e.chart.targetName,e.nameDisabled=!0):e.query.appName?e.value.metadata.name=e.query.appName:e.nameDisabled=!1,e.query.description&&(e.customCmdOpts.description=e.query.description)),!e.forceNamespace||e.existing){t.next=46;break}return t.prev=36,t.next=39,e.$store.dispatch("cluster/find",{type:M["u"],id:e.forceNamespace});case 39:h=t.sent,v=null===(m=h.metadata.annotations)||void 0===m?void 0:m[Y["w"]],v&&(e.project=v.replace(":","/")),t.next=46;break;case 44:t.prev=44,t.t2=t["catch"](36);case 46:if(e.chart&&e.query.versionName){t.next=48;break}return t.abrupt("return");case 48:if(!e.version){t.next=51;break}return t.next=51,e.loadValuesComponent();case 51:return t.next=53,e.loadChartSteps();case 53:e.loadedVersion&&e.loadedVersion===e.version.key||(e.loadedVersion?(e.showingYaml&&e.applyYamlToValues(),y=Object(q["diff"])(e.loadedVersionValues,e.chartValues)):y=e.existing?Object(q["clone"])((null===(w=e.existing.spec)||void 0===w?void 0:w.values)||{}):{},e.removeGlobalValuesFrom(y),e.chartValues=d()(d()({},(null===(f=e.versionInfo)||void 0===f?void 0:f.values)||{}),y),e.showCustomRegistry&&(j=(null===(O=e.chartValues)||void 0===O||null===(C=O.global)||void 0===C?void 0:C.systemDefaultRegistry)||(null===(x=e.chartValues)||void 0===x||null===(N=x.global)||void 0===N||null===(_=N.cattle)||void 0===_?void 0:_.systemDefaultRegistry),null===(k=e.chartValues)||void 0===k||(null===(V=k.global)||void 0===V||delete V.systemDefaultRegistry),null===(S=e.chartValues)||void 0===S||(null===(R=S.global)||void 0===R||(null===(I=R.cattle)||void 0===I||delete I.systemDefaultRegistry)),e.customRegistrySetting=j||e.defaultRegistrySetting,e.showCustomRegistryInput=!!e.customRegistrySetting),e.valuesYaml=Object(H["e"])(e.chartValues),e.loadedVersion||(e.originalYamlValues=e.valuesYaml),e.loadedVersionValues=(null===(g=e.versionInfo)||void 0===g?void 0:g.values)||{},e.loadedVersion=null===(b=e.version)||void 0===b?void 0:b.key),e.updateStepOneReady(),e.preFormYamlOption=e.valuesComponent||e.hasQuestions?J.FORM:J.YAML,e.migratedApp="true"===(null===(r=e.existing)||void 0===r||null===(i=r.spec)||void 0===i||null===(o=i.chart)||void 0===o||null===(l=o.metadata)||void 0===l||null===(u=l.annotations)||void 0===u?void 0:u[Y["e"].MIGRATED]);case 57:case"end":return t.stop()}}),t,null,[[36,44]])})))()},data:function(){var e={cleanupOnFail:!1,crds:!0,hooks:!0,force:!1,resetValues:!1,openApi:!0,wait:!0,timeout:600,historyMax:5};return{defaultRegistrySetting:"",customRegistrySetting:"",serverUrlSetting:null,chartValues:null,clusterRegistry:"",originalYamlValues:null,previousYamlValues:null,errors:null,existing:null,globalRegistry:"",forceNamespace:null,loadedVersion:null,loadedVersionValues:null,legacyApp:null,mcapp:null,mode:null,value:null,valuesComponent:null,valuesYaml:"",project:null,migratedApp:!1,defaultCmdOpts:e,customCmdOpts:z({},e),nameDisabled:!1,preFormYamlOption:J.YAML,formYamlOption:J.YAML,showDiff:!1,showValuesComponent:!0,showQuestions:!0,showSlideIn:!1,shownReadmeWindows:[],componentHasTabs:!1,showCommandStep:!1,showCustomRegistryInput:!1,isNamespaceNew:!1,stepBasic:{name:"basics",label:this.t("catalog.install.steps.basics.label"),subtext:this.t("catalog.install.steps.basics.subtext"),descriptionKey:"catalog.install.steps.basics.description",ready:!0,weight:30},stepClusterTplVersion:{name:"clusterTplVersion",label:this.t("catalog.install.steps.clusterTplVersion.label"),subtext:this.t("catalog.install.steps.clusterTplVersion.subtext"),descriptionKey:"catalog.install.steps.helmValues.description",ready:!0,weight:30},stepValues:{name:"helmValues",label:this.t("catalog.install.steps.helmValues.label"),subtext:this.t("catalog.install.steps.helmValues.subtext"),descriptionKey:"catalog.install.steps.helmValues.description",ready:!0,weight:20},stepCommands:{name:"helmCli",label:this.t("catalog.install.steps.helmCli.label"),subtext:this.t("catalog.install.steps.helmCli.subtext"),descriptionKey:"catalog.install.steps.helmCli.description",ready:!0,weight:10},customSteps:[],isPlainLayout:X(this.$route.query),legacyDefs:{legacy:this.t("catalog.install.error.legacy.category.legacy"),mcm:this.t("catalog.install.error.legacy.category.mcm")}}},computed:z(z({},Object(g["b"])({inStore:"catalog/inStore",features:"features/get"})),{},{mcm:Object(f["mapFeature"])(f["MULTI_CLUSTER"]),namespaceIsNew:function(){var e,t,a=this.$store.getters["cluster/all"](M["u"]),s=null===(e=this.value)||void 0===e||null===(t=e.metadata)||void 0===t?void 0:t.namespace;return!!s&&!Object(F["e"])(a,"id",s)},showProject:function(){return this.isRancher&&!this.existing&&this.forceNamespace},projectOpts:function(){var e=this.currentCluster,t=this.$store.getters["management/all"](L["x"].PROJECT),a=t.filter((function(t){return t.spec.clusterName===(null===e||void 0===e?void 0:e.id)})).map((function(e){return{id:e.id,label:e.nameDisplay,value:e.id}}));return a.unshift({id:"none",label:"(".concat(this.t("generic.none"),")"),value:""}),a},charts:function(){for(var e,t=this,a=null===(e=this.existing)||void 0===e?void 0:e.matchingChart(!0),s=this.$store.getters["catalog/charts"].filter((function(e){return e.key===(null===a||void 0===a?void 0:a.key)||e.chartName===(null===a||void 0===a?void 0:a.chartName)||!(e.hidden&&!t.showHidden)&&!(e.deprecated&&!t.showDeprecated)})),n="",r=0;r<s.length;r++)s[r].repoName!==n&&(n=s[r].repoName,Object(F["g"])(s,r,{kind:"label",label:s[r].repoNameDisplay,disabled:!0}),r++);return s},showSelectVersionOrChart:function(){return this.existing||M["j"]in this.$route.query},showNameEditor:function(){return!this.nameDisabled||!this.forceNamespace},showVersions:function(){var e;return(null===(e=this.chart)||void 0===e?void 0:e.versions.length)>1},targetNamespace:function(){var e;return this.forceNamespace?this.forceNamespace:null!==(e=this.value)&&void 0!==e&&e.metadata.namespace?this.value.metadata.namespace:"default"},editorMode:function(){return this.showDiff?T["a"].DIFF_CODE:T["a"].EDIT_CODE},showingYaml:function(){return this.formYamlOption===J.YAML||!this.valuesComponent&&!this.hasQuestions},showingYamlDiff:function(){return this.formYamlOption===J.DIFF},formYamlOptions:function(){var e=[];return(this.valuesComponent||this.hasQuestions)&&e.push({labelKey:"catalog.install.section.chartOptions",value:J.FORM}),e.push({labelKey:"catalog.install.section.valuesYaml",value:J.YAML},{labelKey:"catalog.install.section.diff",value:J.DIFF,disabled:this.formYamlOption===J.FORM?this.originalYamlValues===u["a"].dump(this.chartValues||{}):this.originalYamlValues===this.valuesYaml}),e},yamlDiffModeOptions:function(){return[{labelKey:"resourceYaml.buttons.unified",value:"unified"},{labelKey:"resourceYaml.buttons.split",value:"split"}]},stepperName:function(){var e,t;return(null===(e=this.existing)||void 0===e?void 0:e.nameDisplay)||(null===(t=this.chart)||void 0===t?void 0:t.chartNameDisplay)},stepperSubtext:function(){return this.existing&&this.currentVersion!==this.targetVersion?"".concat(this.currentVersion," > ").concat(this.targetVersion):this.targetVersion},readmeWindowName:function(){var e;return"".concat(this.stepperName,"-").concat(null===(e=this.version)||void 0===e?void 0:e.version)},showingReadmeWindow:function(){return!!this.$store.getters["wm/byId"](this.readmeWindowName)},diffMode:Object(v["mapPref"])(v["DIFF"]),step1Description:function(){var e=this.steps.find((function(e){return"basics"===e.name})).descriptionKey;return this.$store.getters["i18n/withFallback"](e,{action:this.action,existing:!!this.existing},"")},step2Description:function(){var e=this.steps.find((function(e){return"helmValues"===e.name})).descriptionKey;return this.$store.getters["i18n/withFallback"](e,{action:this.action,existing:!!this.existing},"")},step3Description:function(){var e=this.steps.find((function(e){return"helmCli"===e.name})).descriptionKey;return this.$store.getters["i18n/withFallback"](e,{action:this.action,existing:!!this.existing},"")},steps:function(){var e,t,a,s=[],n=null===(e=this.version)||void 0===e||null===(t=e.annotations)||void 0===t?void 0:t[Y["e"].TYPE];n===Y["e"]._CLUSTER_TPL?((null===(a=this.filteredVersions)||void 0===a?void 0:a.length)>1&&s.push(this.stepClusterTplVersion),s.push(z(z({},this.stepValues),{},{label:this.t("catalog.install.steps.clusterTplValues.label"),subtext:this.t("catalog.install.steps.clusterTplValues.subtext"),descriptionKey:"catalog.install.steps.clusterTplValues.description"}))):s.push.apply(s,[this.stepBasic,this.stepValues].concat(Object(r["a"])(this.customSteps)));return this.showCommandStep&&s.push(this.stepCommands),s.sort((function(e,t){return(t.weight||0)-(e.weight||0)}))},cmdOptions:function(){return this.showCommandStep?this.customCmdOpts:this.defaultCmdOpts},namespaceNewAllowed:function(){return!this.existing&&!this.forceNamespace},legacyEnabled:function(){return this.features(f["LEGACY"])},legacyFeatureRoute:function(){return{name:"c-cluster-product-resource",params:{product:"settings",resource:"management.cattle.io.feature"}}},legacyAppRoute:function(){return{name:"c-cluster-legacy-project"}},windowsIncompatible:function(){var e;if(null!==(e=this.chart)&&void 0!==e&&e.windowsIncompatible)return this.t("catalog.charts.windowsIncompatible");if(this.versionInfo){var t,a,s,n=!((null===(t=this.versionInfo)||void 0===t||null===(a=t.chart)||void 0===a||null===(s=a.annotations)||void 0===s?void 0:s[Y["e"].PERMITTED_OS])||W["LINUX"]).includes("windows");if(n&&!this.chart.windowsIncompatible)return this.t("catalog.charts.versionWindowsIncompatible")}return null},showCustomRegistry:function(){var e,t,a,s=(null===(e=this.versionInfo)||void 0===e||null===(t=e.values)||void 0===t?void 0:t.global)||{};return void 0!==s.systemDefaultRegistry||void 0!==(null===(a=s.cattle)||void 0===a?void 0:a.systemDefaultRegistry)}}),watch:{"$route.query":function(e,t){m()(e,t)||(this.$fetch(),this.showSlideIn=!1)},"value.metadata.namespace":function(e,t){if(e){var a,s=this.$store.getters["cluster/byId"](M["u"],this.value.metadata.namespace),n=null===s||void 0===s||null===(a=s.metadata.annotations)||void 0===a?void 0:a[Y["w"]];n&&(this.project=n.replace(":","/"))}},preFormYamlOption:function(e,t){e===J.FORM&&this.valuesYaml!==this.previousYamlValues&&this.$refs.cancelModal?this.$refs.cancelModal.show():this.formYamlOption=e},formYamlOption:function(e,t){switch(e){case J.FORM:this.valuesYaml=this.previousYamlValues,this.showValuesComponent=!0,this.showQuestions=!0,this.showDiff=!1;break;case J.YAML:t===J.FORM&&(this.valuesYaml=u["a"].dump(this.chartValues||{}),this.previousYamlValues=this.valuesYaml),this.showValuesComponent=!1,this.showQuestions=!1,this.showDiff=!1;break;case J.DIFF:t===J.FORM&&(this.valuesYaml=u["a"].dump(this.chartValues||{}),this.previousYamlValues=this.valuesYaml),this.showValuesComponent=!1,this.showQuestions=!1,this.updateValue(this.valuesYaml),this.showDiff=!0;break}},requires:function(){this.updateStepOneReady()},warnings:function(){this.updateStepOneReady()}},mounted:function(){var e=this;return Object(o["a"])(c.a.mark((function t(){return c.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.loadValuesComponent();case 2:return t.next=4,e.loadChartSteps();case 4:window.scrollTop=0,e.preFormYamlOption=e.valuesComponent||e.hasQuestions?J.FORM:J.YAML;case 6:case"end":return t.stop()}}),t)})))()},beforeDestroy:function(){var e=this;this.shownReadmeWindows.forEach((function(t){return e.$store.dispatch("wm/close",t,{root:!0})}))},methods:{getClusterRegistry:function(){var e=this;return Object(o["a"])(c.a.mark((function t(){var a,s,n,r,i,o,l,u,p,d,h,m;return c.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=e.$store.getters["management/schemaFor"](L["e"].RANCHER_CLUSTER),!a){t.next=21;break}if(s=e.$store.getters["currentCluster"],null===s||void 0===s||!s.provClusterId){t.next=9;break}return t.next=6,e.$store.dispatch("management/find",{type:L["e"].RANCHER_CLUSTER,id:s.provClusterId});case 6:t.t0=t.sent,t.next=10;break;case 9:t.t0={};case 10:if(n=t.t0,!n.isRke2){t.next=16;break}if(l=null===(r=n.spec)||void 0===r||null===(i=r.rkeConfig)||void 0===i||null===(o=i.machineSelectorConfig)||void 0===o?void 0:o.find((function(e){return!e.machineLabelSelector})).config,u=(null===l||void 0===l?void 0:l["system-default-registry"])||"",!u){t.next=16;break}return t.abrupt("return",u);case 16:if(!n.isRke1){t.next=21;break}if(h=null===(p=s.spec)||void 0===p||null===(d=p.rancherKubernetesEngineConfig)||void 0===d?void 0:d.privateRegistries,!((null===h||void 0===h?void 0:h.length)>0)){t.next=21;break}return m=h.find((function(e){return e.isDefault})),t.abrupt("return",m.url);case 21:case"end":return t.stop()}}),t)})))()},getGlobalRegistry:function(){var e=this;return Object(o["a"])(c.a.mark((function t(){var a;return c.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("management/find",{type:L["x"].SETTING,id:"system-default-registry"});case 2:return a=t.sent,t.abrupt("return",a.value);case 4:case"end":return t.stop()}}),t)})))()},updateValue:function(e){this.$refs.yaml&&this.$refs.yaml.updateValue(e)},loadValuesComponent:function(){var e=this;return Object(o["a"])(c.a.mark((function t(){var a,s,n,r,i,o;return c.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=null===(a=e.version)||void 0===a||null===(s=a.annotations)||void 0===s?void 0:s[Y["e"].COMPONENT],!n){t.next=17;break}if(r=e.$store.getters["type-map/hasCustomChart"](n),!r){t.next=12;break}return e.valuesComponent=e.$store.getters["type-map/importChart"](n),t.next=7,e.valuesComponent();case 7:o=t.sent,e.showValuesComponent=!0,e.componentHasTabs=(null===o||void 0===o||null===(i=o.default)||void 0===i?void 0:i.hasTabs)||!1,t.next=15;break;case 12:e.valuesComponent=null,e.componentHasTabs=!1,e.showValuesComponent=!1;case 15:t.next=20;break;case 17:e.valuesComponent=null,e.componentHasTabs=!1,e.showValuesComponent=!1;case 20:case"end":return t.stop()}}),t)})))()},loadChartSteps:function(){var e=this;return Object(o["a"])(c.a.mark((function t(){var a,s,n,r;return c.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=null===(a=e.version)||void 0===a||null===(s=a.annotations)||void 0===s?void 0:s[Y["e"].COMPONENT],!n){t.next=8;break}return t.next=4,e.$store.getters["catalog/chartSteps"](n);case 4:return r=t.sent,t.next=7,Promise.all(r.map((function(t){return e.loadChartStep(t)})));case 7:e.customSteps=t.sent;case 8:case"end":return t.stop()}}),t)})))()},loadChartStep:function(e){var t=this;return Object(o["a"])(c.a.mark((function a(){var s,n,r,i,o;return c.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,e.component();case 2:return i=a.sent,o=t.$store.getters["i18n/withFallback"],a.abrupt("return",{name:e.name,label:o(null===i||void 0===i||null===(s=i.default)||void 0===s?void 0:s.label,null,e.name),subtext:o(null===i||void 0===i||null===(n=i.default)||void 0===n?void 0:n.subtext,null,""),weight:null===i||void 0===i||null===(r=i.default)||void 0===r?void 0:r.weight,ready:!1,hidden:!0,loading:!0,component:e.component});case 5:case"end":return a.stop()}}),a)})))()},selectChart:function(e){var t;e&&this.$router.applyQuery((t={},Object(i["a"])(t,M["y"],e.repoName),Object(i["a"])(t,M["z"],e.repoType),Object(i["a"])(t,M["d"],e.chartName),Object(i["a"])(t,M["G"],e.versions[0].version),t))},cancel:function(){this.existing?this.done():this.$route.query[M["j"]]===M["M"]?this.$router.replace(this.clusterToolsLocation()):this.$route.query[M["i"]]===M["M"]?this.$router.replace(this.clustersLocation()):this.$router.replace(this.chartLocation(!1))},done:function(){this.$route.query[M["j"]]===M["M"]?this.$router.replace(this.clusterToolsLocation()):this.$route.query[M["i"]]===M["M"]?this.$router.replace(this.clustersLocation()):this.$router.replace(this.appLocation())},finish:function(e){var t=this;return Object(o["a"])(c.a.mark((function a(){var s,n,r,i,o,l;return c.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,s=!!t.existing,t.errors=[],a.next=5,t.applyHooks(E["b"]);case 5:if(n=t.actionInput(s),r=n.errors,i=n.input,null===r||void 0===r||!r.length){a.next=10;break}return t.errors=r,e(!1),a.abrupt("return");case 10:return a.next=12,t.repo.doAction(s?"upgrade":"install",i);case 12:return o=a.sent,l="".concat(o.operationNamespace,"/").concat(o.operationName),a.next=16,t.repo.waitForOperation(l);case 16:return a.next=18,t.$store.dispatch("".concat(t.inStore,"/find"),{type:L["f"].OPERATION,id:l});case 18:return t.operation=a.sent,a.prev=19,a.next=22,t.operation.waitForLink("logs");case 22:t.operation.openLogs(),a.next=27;break;case 25:a.prev=25,a.t0=a["catch"](19);case 27:return a.next=29,t.applyHooks(E["a"]);case 29:e(!0),t.done(),a.next=37;break;case 33:a.prev=33,a.t1=a["catch"](0),t.errors=Object(A["c"])(a.t1),e(!1);case 37:case"end":return a.stop()}}),a,null,[[0,33],[19,25]])})))()},addGlobalValuesTo:function(e){var t,a,s,n,r,i,o,l,c=e.global;c||(c={},Object(q["set"])(e,"global",c));var u=c.cattle;u||(u={},Object(q["set"])(e.global,"cattle",u));var p=this.currentCluster,d=this.$store.getters["management/all"](L["x"].PROJECT),h=(null===(t=d.find((function(e){var t;return"System"===(null===(t=e.spec)||void 0===t?void 0:t.displayName)})))||void 0===t||null===(a=t.id)||void 0===a||null===(s=a.split("/"))||void 0===s?void 0:s[1])||"",m=(null===(n=this.serverUrlSetting)||void 0===n?void 0:n.value)||"",v=((null===p||void 0===p?void 0:p.workerOSs)||[]).includes(W["WINDOWS"]),f=(null===p||void 0===p||null===(r=p.spec)||void 0===r||null===(i=r.rancherKubernetesEngineConfig)||void 0===i?void 0:i.prefixPath)||"",g=(null===p||void 0===p||null===(o=p.spec)||void 0===o||null===(l=o.rancherKubernetesEngineConfig)||void 0===l?void 0:l.winPrefixPath)||"";return b(u,"clusterId",null===p||void 0===p?void 0:p.id),b(u,"clusterName",null===p||void 0===p?void 0:p.nameDisplay),this.showCustomRegistry&&(Object(q["set"])(u,"systemDefaultRegistry",this.customRegistrySetting),Object(q["set"])(c,"systemDefaultRegistry",this.customRegistrySetting)),b(c,"cattle.systemProjectId",h),b(u,"url",m),b(u,"rkePathPrefix",f),b(u,"rkeWindowsPathPrefix",g),v&&b(u,"windows.enabled",!0),e;function b(e,t,a){"undefined"===typeof Object(q["get"])(e,t)&&Object(q["set"])(e,t,a)}},removeGlobalValuesFrom:function(e){var t,a,s,n,r,i,o,l,c;if(e){var u=this.$store.getters["currentCluster"],p=(null===(t=this.serverUrlSetting)||void 0===t?void 0:t.value)||"",d=((null===u||void 0===u?void 0:u.workerOSs)||[]).includes(W["WINDOWS"]),h=(null===u||void 0===u||null===(a=u.spec)||void 0===a||null===(s=a.rancherKubernetesEngineConfig)||void 0===s?void 0:s.prefixPath)||"",m=(null===u||void 0===u||null===(n=u.spec)||void 0===n||null===(r=n.rancherKubernetesEngineConfig)||void 0===r?void 0:r.winPrefixPath)||"";return null!==(i=e.global)&&void 0!==i&&i.cattle&&(v(e.global.cattle,"clusterId",null===u||void 0===u?void 0:u.id),v(e.global.cattle,"clusterName",null===u||void 0===u?void 0:u.nameDisplay),v(e.global.cattle,"url",p),v(e.global.cattle,"rkePathPrefix",h),v(e.global.cattle,"rkeWindowsPathPrefix",m),d&&v(e.global.cattle.windows,"enabled",!0)),null!==(o=e.global)&&void 0!==o&&null!==(l=o.cattle)&&void 0!==l&&l.windows&&!Object.keys(e.global.cattle.windows).length&&delete e.global.cattle.windows,null!==(c=e.global)&&void 0!==c&&c.cattle&&!Object.keys(e.global.cattle).length&&delete e.global.cattle,Object.keys(e.global||{}).length||delete e.global,e}function v(e,t,a){Object(q["get"])(e,t)===a&&delete e[t]}},applyYamlToValues:function(){try{this.chartValues=u["a"].load(this.valuesYaml)}catch(e){return{errors:Object(A["c"])(e)}}return{errors:[]}},actionInput:function(e){var t,a,s,n,o,l,c,u=(null===(t=this.versionInfo)||void 0===t?void 0:t.values)||{},p=[];if(this.showingYaml||this.showingYamlDiff){var d=this.applyYamlToValues(),h=d.errors;p.push.apply(p,Object(r["a"])(h))}var m=Object(q["diff"])(u,this.chartValues);this.addGlobalValuesTo(m);var v=JSON.parse(JSON.stringify(this.value)),f=this.migratedApp?Object(i["a"])({},Y["e"].MIGRATED,"true"):{},g={chartName:this.chart.chartName,version:(null===(a=this.version)||void 0===a?void 0:a.version)||this.query.versionName,releaseName:v.metadata.name,description:this.customCmdOpts.description,annotations:z(z({},f),{},(s={},Object(i["a"])(s,Y["e"].SOURCE_REPO_TYPE,this.chart.repoType),Object(i["a"])(s,Y["e"].SOURCE_REPO_NAME,this.chart.repoName),s)),values:m};e&&(g.resetValues=this.cmdOptions.resetValues);var b={charts:[g],noHooks:!1===this.cmdOptions.hooks,timeout:this.cmdOptions.timeout>0?"".concat(this.cmdOptions.timeout,"s"):null,wait:!0===this.cmdOptions.wait,namespace:v.metadata.namespace,projectId:this.project};e?(b.force=!0===this.cmdOptions.force,b.historyMax=this.cmdOptions.historyMax,b.cleanupOnFail=this.cmdOptions.cleanupOnFail):(b.disableOpenAPIValidation=!1===this.cmdOptions.openApi,b.skipCRDs=!1===this.cmdOptions.crds);var y,w=[],O=((null===(n=this.version)||void 0===n||null===(o=n.annotations)||void 0===o?void 0:o[Y["e"].AUTO_INSTALL])||"").split(/\s*,\s*/).filter((function(e){return!!e})).reverse(),C=B(O);try{for(C.s();!(y=C.n()).done;){var x=y.value,N=this.$store.getters["catalog/versionSatisfying"]({constraint:x,repoName:this.chart.repoName,repoType:this.chart.repoType,chartVersion:this.version.version});N?w.push(N):p.push("This chart requires ".concat(x," but no matching chart was found"))}}catch(P){C.e(P)}finally{C.f()}O=((null===(l=this.version)||void 0===l||null===(c=l.annotations)||void 0===c?void 0:c[Y["e"].AUTO_INSTALL_GVK])||"").split(/\s*,\s*/).filter((function(e){return!!e})).reverse();var _,k=B(O);try{for(k.s();!(_=k.n()).done;){var V=_.value,S=this.$store.getters["catalog/versionProviding"]({gvr:V,repoName:this.chart.repoName,repoType:this.chart.repoType});S?w.push(S):p.push("This chart requires another chart that provides ".concat(V,", but none was was found"))}}catch(P){k.e(P)}finally{k.f()}for(var R=0,I=w;R<I.length;R++){var j,T=I[R];b.charts.unshift({chartName:T.name,version:T.version,releaseName:T.annotations[Y["e"].RELEASE_NAME]||T.name,projectId:this.project,values:this.addGlobalValuesTo({global:m.global}),annotations:z(z({},f),{},(j={},Object(i["a"])(j,Y["e"].SOURCE_REPO_TYPE,T.repoType),Object(i["a"])(j,Y["e"].SOURCE_REPO_NAME,T.repoName),j))})}return{errors:p,input:b}},tabChanged:function(){window.scrollTop=0},updateStepOneReady:function(){var e=!this.requires.length,t=!!this.chart;this.steps[0].ready=e&&t},getOptionLabel:function(e){return null===e||void 0===e?void 0:e.chartNameDisplay},showReadmeWindow:function(){this.$store.dispatch("wm/open",{id:this.readmeWindowName,label:this.readmeWindowName,icon:"file",component:"ChartReadme",attrs:{versionInfo:this.versionInfo}},{root:!0}),this.shownReadmeWindows.push(this.readmeWindowName)},updateStep:function(e,t){var a=this.steps.find((function(t){return t.name===e}));if(a)for(var s in t)U["default"].set(a,s,t[s])}}},ee=Z,te=(a("0f25"),a("0c7c")),ae=Object(te["a"])(ee,s,n,!1,null,"06939347",null);t["default"]=ae.exports},"66f8":function(e,t,a){}}]);
//# sourceMappingURL=install.bbcc60da.js.map