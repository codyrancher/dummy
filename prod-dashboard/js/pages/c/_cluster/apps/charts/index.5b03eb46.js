(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages/c/_cluster/apps/charts/index"],{"54d1":function(e,t,r){"use strict";r("7836")},6454:function(e,t,r){},7836:function(e,t,r){},be43:function(e,t,r){"use strict";r("6454")},e78d:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.$fetchState.pending?r("Loading"):r("div",[r("header",[r("div",{staticClass:"title"},[r("h1",{staticClass:"m-0"},[e._v(" "+e._s(e.t("catalog.charts.header"))+" ")])]),e.getFeaturedCharts.length>0?r("div",{staticClass:"actions-container"},[r("ButtonGroup",{attrs:{options:e.chartOptions},model:{value:e.chartMode,callback:function(t){e.chartMode=t},expression:"chartMode"}})],1):e._e()]),e.showCarousel?r("div",[r("h3",[e._v(e._s(e.t("catalog.charts.featuredCharts")))]),r("Carousel",{attrs:{sliders:e.getFeaturedCharts},on:{clicked:function(t){return e.selectChart(t)}}})],1):e._e(),e.isPspLegacy?r("Banner",{attrs:{color:"warning",label:e.t("catalog.chart.banner.legacy")}}):e._e(),r("TypeDescription",{attrs:{resource:"chart"}}),r("div",{staticClass:"left-right-split"},[r("Select",{staticClass:"checkbox-select",attrs:{searchable:!1,options:e.repoOptionsForDropdown,value:e.flattenedRepoNames,"close-on-select":!1},on:{"option:selecting":function(t){t.all?e.toggleAll(!t.enabled):e.toggleRepo(t,!t.enabled)}},scopedSlots:e._u([{key:"selected-option",fn:function(t){return[e._v(" "+e._s(t.label)+" ")]}},{key:"option",fn:function(t){var n;return[r("Checkbox",{staticClass:"pull-left repo in-select",class:(n={},n[t.color]=!0,n),attrs:{value:t.enabled,label:t.label,color:t.color},scopedSlots:e._u([{key:"label",fn:function(){var n;return[r("span",[e._v(e._s(t.label))]),t.all?e._e():r("i",{staticClass:" pl-5 icon icon-dot icon-sm",class:(n={},n[t.color]=!0,n)})]},proxy:!0}],null,!0)})]}}])}),r("Select",{staticStyle:{"min-width":"200px"},attrs:{clearable:!1,searchable:!1,options:e.categories,placement:"bottom",label:"label",reduce:function(e){return e.value}},scopedSlots:e._u([{key:"option",fn:function(t){return[e._v(" "+e._s(t.label)+" ("+e._s(t.count)+") ")]}}]),model:{value:e.category,callback:function(t){e.category=t},expression:"category"}}),r("div",{staticClass:"filter-block"},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.searchQuery,expression:"searchQuery"}],ref:"searchQuery",staticClass:"input-sm",attrs:{type:"search",placeholder:e.t("catalog.charts.search")},domProps:{value:e.searchQuery},on:{input:function(t){t.target.composing||(e.searchQuery=t.target.value)}}}),r("button",{directives:[{name:"shortkey",rawName:"v-shortkey.once",value:["/"],expression:"['/']",modifiers:{once:!0}}],staticClass:"hide",on:{shortkey:function(t){return e.focusSearch()}}}),r("AsyncButton",{staticClass:"refresh-btn",attrs:{mode:"refresh",size:"sm"},on:{click:e.refresh}})],1)],1),e._l(e.loadingErrors,(function(e){return r("Banner",{key:e,attrs:{color:"error",label:e}})})),e.allCharts.length?r("div",[0===e.filteredCharts.length?r("div",{staticStyle:{width:"100%"}},[r("div",{staticClass:"m-50 text-center"},[r("h1",[e._v(e._s(e.t("catalog.charts.noCharts")))])])]):r("SelectIconGrid",{attrs:{rows:e.filteredCharts,"name-field":"chartNameDisplay","description-field":"chartDescription","color-for":e.colorForChart},on:{clicked:function(t){return e.selectChart(t)}}})],1):r("div",{staticClass:"m-50 text-center"},[r("h1",[e._v(e._s(e.t("catalog.charts.noCharts")))])])],2)},s=[],a=(r("1d8f"),r("13ec"),r("7e5b"),r("38aa"),r("bcff"),r("0b7a"),r("46d9"),r("a41c"),r("d323"),r("2869"),r("a797"),r("5986"),r("2909")),o=r("ade3"),i=r("1da1"),c=(r("bb4d"),r("9ce4"),r("6d55"),r("2b77"),r("9d9d"),r("8be0"),r("cf99"),r("e89d"),r("b61e"),r("4d7f"),r("b667"),r("6102"),r("a34a")),l=r.n(c),u=(r("96cf"),r("67c9")),d=r("c778"),h=r("bec1"),f=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"slider"},[r("div",{ref:"slider",staticClass:"slide-track",style:e.trackStyle,attrs:{id:"slide-track"}},e._l(e.sliders,(function(t,n){return r(e.asLink?"a":"div",{key:e.get(t,e.keyField),ref:"slide",refInFor:!0,tag:"div",staticClass:"slide",attrs:{id:"slide"+n,href:e.asLink?e.get(t,e.linkField):null,target:e.get(t,e.targetField),rel:e.rel},on:{click:function(r){return e.select(t,n)}}},[r("div",{staticClass:"slide-content"},[r("div",{staticClass:"slide-img"},[r("img",{attrs:{src:t.icon?t.icon:"/_nuxt/shell/assets/images/generic-catalog.svg"}})]),r("div",{staticClass:"slide-content-right"},[r("BadgeState",{attrs:{label:t.repoName,color:"slider-badge mb-20"}}),r("h1",[e._v(e._s(t.chartNameDisplay))]),r("p",[e._v(e._s(t.chartDescription))])],1)])])})),1),r("div",{staticClass:"controls"},e._l(e.slider,(function(t,n){return r("div",{key:n,staticClass:"control-item",class:{active:e.activeItemId===n},on:{click:function(t){return e.scrollSlide(n,e.slider.length)}}})})),0),r("div",{ref:"prev",staticClass:"prev",class:[0===e.activeItemId?"disabled":"prev"],on:{click:function(t){return e.nextPrev("prev")}}},[r("i",{staticClass:"icon icon-chevron-left icon-4x"})]),r("div",{ref:"next",staticClass:"next",class:[e.activeItemId===e.slider.length-1?"disabled":"next"],on:{click:function(t){return e.nextPrev("next")}}},[r("i",{staticClass:"icon icon-chevron-right icon-4x"})])])},p=[],v=r("de78"),b=r("4297"),g=r("2f62");function y(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function m(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?y(Object(r),!0).forEach((function(t){Object(o["a"])(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var O="carousel-seen",w={components:{BadgeState:b["a"]},name:"Carousel",props:{sliders:{type:Array,required:!0},keyField:{type:String,default:"key"},asLink:{type:Boolean,default:!1},linkField:{type:String,default:"link"},targetField:{type:String,default:"target"},rel:{type:String,default:"noopener noreferrer nofollow"}},data:function(){return{slider:this.sliders,activeItemId:0,autoScroll:!0,autoScrollSlideInterval:null}},computed:m(m({},Object(g["b"])(["clusterId"])),{},{trackStyle:function(){var e=100*this.activeItemId/this.slider.length,t=60*this.slider.length;return"transform: translateX(-".concat(e,"%); width: ").concat(t,"%")}}),methods:{get:v["get"],select:function(e,t){this.$emit("clicked",e,t)},scrollSlide:function(e){var t=this;this.autoScroll=!1,this.activeItemId=e,setTimeout((function(){t.slidePosition()}),400)},nextPrev:function(e){this.autoScroll=!1,"next"===e&&this.activeItemId<this.slider.length-1&&this.activeItemId++,"prev"===e&&this.activeItemId>0&&this.activeItemId--,this.slidePosition()},autoScrollSlide:function(){this.activeItemId<this.slider.length&&this.autoScroll&&this.activeItemId++,this.activeItemId>this.slider.length-1&&(this.autoScroll=!1,this.activeItemId=0),this.slidePosition()},slidePosition:function(){this.activeItemId<=1?(this.$refs.slide[this.slider.length-1].style.left="-93%",this.$refs.slide[0].style.left="7%"):(this.$refs.slide[this.slider.length-1].style.left="7%",this.$refs.slide[0].style.left="107%")}},beforeDestroy:function(){this.autoScrollSlideInterval&&clearInterval(this.autoScrollSlideInterval)},mounted:function(){var e=sessionStorage.getItem(O);e!==this.clusterId&&(sessionStorage.setItem(O,this.clusterId),this.autoScrollSlideInterval=setInterval(this.autoScrollSlide,5e3))}},C=w,S=(r("54d1"),r("0c7c")),k=Object(S["a"])(C,f,p,!1,null,"5ef078aa",null),j=k.exports,_=r("5557"),I=r("c4a1"),P=r("35f4"),x=r("fa3b"),$=r("2c94"),D=r("b25d"),E=r("4de2"),R=r("c989"),A=r("e528"),F=r("f303"),Q=r("5ce5"),L=r("7388"),B=r("7600");function H(e,t){var r="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=T(e))||t&&e&&"number"===typeof e.length){r&&(e=r);var n=0,s=function(){};return{s:s,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,i=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){i=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(i)throw a}}}}function T(e,t){if(e){if("string"===typeof e)return M(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?M(e,t):void 0}}function M(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function N(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function G(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?N(Object(r),!0).forEach((function(t){Object(o["a"])(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):N(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var q={name:"Charts",components:{AsyncButton:u["b"],Banner:h["a"],Carousel:j,ButtonGroup:_["a"],Loading:d["a"],Checkbox:E["a"],Select:R["a"],SelectIconGrid:I["a"],TypeDescription:P["a"]},fetch:function(){var e=this;return Object(i["a"])(l.a.mark((function t(){var r;return l.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("catalog/load",{force:!0,reset:!0});case 2:r=e.$route.query,e.searchQuery=r[x["A"]]||"",e.showDeprecated=r[x["f"]]===x["M"],e.showHidden=r[x["o"]]===x["M"],e.category=r[x["c"]]||"",e.allRepos=e.areAllEnabled();case 8:case"end":return t.stop()}}),t)})))()},data:function(){return{allRepos:null,category:null,operatingSystem:null,searchQuery:null,showDeprecated:null,showHidden:null,isPspLegacy:!1,chartOptions:[{label:"Browse",value:"browse"},{label:"Featured",value:"featured"}]}},computed:G(G(G({},Object(g["b"])(["currentCluster"])),Object(g["b"])({allCharts:"catalog/charts",loadingErrors:"catalog/errors"})),{},{chartMode:Object(A["mapPref"])(A["SHOW_CHART_MODE"]),hideRepos:Object(A["mapPref"])(A["HIDE_REPOS"]),repoOptions:function(){var e=this,t=0,r=[1,2,5,6,7,8],n=this.$store.getters["catalog/repos"].map((function(t){return{_key:t._key,label:t.nameDisplay,color:t.color,weight:t.isRancher?1:t.isPartner?2:3,enabled:!e.hideRepos.includes(t._key)}}));n=Object(D["b"])(n,["weight","label"]);var s,a=H(n);try{for(a.s();!(s=a.n()).done;){var o=s.value;o.color||(o.color="color".concat(r[t]),t++,t>=r.length&&(t=0))}}catch(i){a.e(i)}finally{a.f()}return n},repoOptionsForDropdown:function(){return[{label:this.t("catalog.repo.all"),all:!0,enabled:this.areAllEnabled()}].concat(Object(a["a"])(this.repoOptions))},flattenedRepoNames:function(){var e=this,t=this.repoOptionsForDropdown.find((function(e){return e.all&&e.enabled}));if(t)return t.label;if(!this.repoOptionsForDropdown.find((function(e){return e.enabled})))return this.t("generic.none");var r=this.repoOptions.filter((function(t){return!e.hideRepos.includes(t._key)})),n=r.reduce((function(e,t,n){e+=t.label;var s=r.length;return n<s-1&&(e+=", "),e}),"");return n},enabledCharts:function(){var e=this;return(this.allCharts||[]).filter((function(t){return!(t.deprecated&&!e.showDeprecated)&&(!(t.hidden&&!e.showHidden)&&(!e.hideRepos.includes(t.repoKey)&&!Object(B["m"])(t)))}))},filteredCharts:function(){var e=this.enabledCharts||[],t=this.currentCluster.status.provider||"other";return Object(Q["filterAndArrangeCharts"])(e,{clusterProvider:t,category:this.category,searchQuery:this.searchQuery,showDeprecated:this.showDeprecated,showHidden:this.showHidden,hideRepos:this.hideRepos,hideTypes:[L["e"]._CLUSTER_TPL],showPrerelease:this.$store.getters["prefs/get"](A["SHOW_PRE_RELEASE"])})},getFeaturedCharts:function(){var e=this.filteredCharts||[],t=e.filter((function(e){return e.featured})).sort((function(e,t){return e.featured-t.featured}));return t.slice(0,5)},categories:function(){var e,t={},r=H(this.enabledCharts);try{for(r.s();!(e=r.n()).done;){var n,s=e.value,a=H(s.categories);try{for(a.s();!(n=a.n()).done;){var o=n.value;if(!t[o]){var i="catalog.charts.categories.".concat(Object($["l"])(o));t[o]={label:this.$store.getters["i18n/withFallback"](i,null,o),value:o,count:0}}t[o].count++}}catch(l){a.e(l)}finally{a.f()}}}catch(l){r.e(l)}finally{r.f()}var c=Object.values(t);return c.unshift({label:this.t("catalog.charts.categories.all"),value:"",count:this.enabledCharts.length}),c},showCarousel:function(){return"featured"===this.chartMode&&this.getFeaturedCharts.length}}),watch:{searchQuery:function(e){this.$router.applyQuery(Object(o["a"])({},x["A"],e||void 0))},category:function(e){this.$router.applyQuery(Object(o["a"])({},x["c"],e||void 0))},operatingSystem:function(e){this.$router.applyQuery(Object(o["a"])({},x["v"],e||void 0))}},mounted:function(){"undefined"!==typeof window&&(window.c=this)},created:function(){var e,t,r=(null===(e=this.currentCluster)||void 0===e||null===(t=e.status)||void 0===t?void 0:t.version.gitVersion)||"",n=r.includes("rke2"),s=r.match(/\d+/g);this.isPspLegacy=!(null===s||void 0===s||!s.length)&&(n&&1===+s[0]&&+s[1]<25)},methods:{colorForChart:function(e){var t=this.repoOptions,r=Object(F["e"])(t,"_key",e.repoKey);return r?r.color:null},toggleAll:function(e){var t,r=this,n=H(this.repoOptions);try{for(n.s();!(t=n.n()).done;){var s=t.value;this.toggleRepo(s,e,!1)}}catch(a){n.e(a)}finally{n.f()}this.$nextTick((function(){r.allRepos=r.areAllEnabled()}))},areAllEnabled:function(){var e,t=this.$store.getters["catalog/repos"],r=H(t);try{for(r.s();!(e=r.n()).done;){var n=e.value;if(this.hideRepos.includes(n._key))return!1}}catch(s){r.e(s)}finally{r.f()}return!0},toggleRepo:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=this.hideRepos;t?Object(F["j"])(n,e._key):Object(F["a"])(n,e._key),this.hideRepos=n,r&&(this.allRepos=this.areAllEnabled())},selectChart:function(e){var t,r,n=this.currentCluster.workerOSs,s=this.$store.getters["prefs/get"](A["SHOW_PRE_RELEASE"]),a=Object(Q["compatibleVersionsFor"])(e,n,s),i=e.versions;r=a.length>0?a[0].version:i[0].version,this.$router.push({name:"c-cluster-apps-charts-chart",params:{cluster:this.$route.params.cluster,product:this.$store.getters["productId"]},query:(t={},Object(o["a"])(t,x["z"],e.repoType),Object(o["a"])(t,x["y"],e.repoName),Object(o["a"])(t,x["d"],e.chartName),Object(o["a"])(t,x["G"],r),t)})},focusSearch:function(){this.$refs.searchQuery&&(this.$refs.searchQuery.focus(),this.$refs.searchQuery.select())},refresh:function(e){var t=this;return Object(i["a"])(l.a.mark((function r(){return l.a.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,t.$store.dispatch("catalog/refresh");case 3:e(!0),r.next=10;break;case 6:r.prev=6,r.t0=r["catch"](0),t.$store.dispatch("growl/fromError",r.t0),e(!1);case 10:case"end":return r.stop()}}),r,null,[[0,6]])})))()}}},W=q,z=(r("be43"),Object(S["a"])(W,n,s,!1,null,"ddeadd90",null));t["default"]=z.exports}}]);
//# sourceMappingURL=index.5b03eb46.js.map