(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages/c/_cluster/_product/projectsnamespaces"],{85028:function(e,t,r){},8805:function(e,t,r){},"96a3":function(e,t,r){"use strict";r("8805")},"97db":function(e,t,r){"use strict";r("85028")},fdba:function(e,t,r){"use strict";r.r(t);var o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("ExplorerProjectsNamespaces",e._b({},"ExplorerProjectsNamespaces",e.$attrs,!1))},n=[],a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"project-namespaces"},[r("Masthead",{attrs:{schema:e.projectSchema,"type-display":e.t("projectNamespaces.label"),resource:e.MANAGEMENT.PROJECT,"favorite-resource":e.VIRTUAL_TYPES.PROJECT_NAMESPACES,"create-location":e.createProjectLocation,"create-button-label":e.t("projectNamespaces.createProject"),"show-incremental-loading-indicator":e.showIncrementalLoadingIndicator,"load-resources":e.loadResources,"load-indeterminate":e.loadIndeterminate}}),r("ResourceTable",e._g(e._b({ref:"table",staticClass:"table",attrs:{schema:e.schema,headers:e.headers,rows:e.filteredRows,groupable:!0,"sort-generation-fn":e.sortGenerationFn,loading:e.loading,"group-tooltip":"resourceTable.groupBy.project","key-field":"_key"},scopedSlots:e._u([{key:"group-by",fn:function(t){return[r("div",{staticClass:"project-bar",class:{"has-description":e.projectDescription(t.group)}},[r("div",{directives:[{name:"trim-whitespace",rawName:"v-trim-whitespace"}],staticClass:"group-tab"},[r("div",{staticClass:"project-name",domProps:{innerHTML:e._s(e.projectLabel(t.group))}}),e.projectDescription(t.group)?r("div",{staticClass:"description text-muted text-small"},[e._v(" "+e._s(e.projectDescription(t.group))+" ")]):e._e()]),r("div",{staticClass:"right"},[e.isNamespaceCreatable&&(e.canSeeProjectlessNamespaces||t.group.key!==e.notInProjectKey)?r("n-link",{staticClass:"create-namespace btn btn-sm role-secondary mr-5",attrs:{to:e.createNamespaceLocation(t.group)}},[e._v(" "+e._s(e.t("projectNamespaces.createNamespace"))+" ")]):e._e(),r("button",{staticClass:"project-action btn btn-sm role-multi-action actions mr-10",class:{invisible:!e.showProjectActionButton(t.group)},attrs:{type:"button"},on:{click:function(r){return e.showProjectAction(r,t.group)}}},[r("i",{staticClass:"icon icon-actions"})])],1)])]}},{key:"cell:project",fn:function(t){var o=t.row;return[o.project?r("span",[e._v(e._s(o.project.nameDisplay))]):r("span",{staticClass:"text-muted"},[e._v("â€“")])]}},{key:"cell:name",fn:function(t){var o=t.row;return[r("div",{staticClass:"namespace-name"},[o.detailLocation&&!o.hideDetailLocation?r("n-link",{attrs:{to:o.detailLocation}},[e._v(" "+e._s(o.name)+" ")]):r("span",[e._v(" "+e._s(o.name)+" ")]),o.hasSystemLabels?r("i",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.getPsaTooltip(o),expression:"getPsaTooltip(row)"}],staticClass:"icon icon-lock ml-5"}):e._e()],1)]}},e._l(e.projectsWithoutNamespaces,(function(t){return{key:e.slotName(t),fn:function(){return[r("tr",{key:t.id,staticClass:"main-row"},[r("td",{staticClass:"empty text-center",attrs:{colspan:"5"}},[e._v(" "+e._s(e.t("projectNamespaces.noNamespaces"))+" ")])])]},proxy:!0}})),{key:"main-row:fake-empty",fn:function(){return[r("tr",{staticClass:"main-row"},[r("td",{staticClass:"empty text-center",attrs:{colspan:"5"}},[e._v(" "+e._s(e.t("projectNamespaces.noProjectNoNamespaces"))+" ")])])]},proxy:!0}],null,!0)},"ResourceTable",e.$attrs,!1),e.$listeners)),r("MoveModal",{on:{moving:e.clearSelection}})],1)},c=[],s=(r("7e5b"),r("38aa"),r("bcff"),r("b61e"),r("46d9"),r("a41c"),r("b667"),r("2869"),r("a797"),r("5986"),r("3835")),i=r("2909"),u=r("ade3"),l=r("1da1"),p=(r("0b7a"),r("9ce4"),r("6d55"),r("cf99"),r("8be0"),r("bb4d"),r("9d9d"),r("4a9f"),r("2b77"),r("1d8f"),r("181c"),r("e89d"),r("4d7f"),r("13ec"),r("d323"),r("a34a")),m=r.n(p),f=(r("96cf"),r("2f62")),d=r("b178"),h=r("9149"),j=r("f303"),v=r("a788"),b=r("fa3b"),g=r("39ce"),P=r("e528"),y=r("e115"),w=r("ccc6"),N=r("2730");function O(e,t){var r="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=S(e))||t&&e&&"number"===typeof e.length){r&&(e=r);var o=0,n=function(){};return{s:n,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,c=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return c=e.done,e},e:function(e){s=!0,a=e},f:function(){try{c||null==r.return||r.return()}finally{if(s)throw a}}}}function S(e,t){if(e){if("string"===typeof e)return C(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?C(e,t):void 0}}function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}function _(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function A(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?_(Object(r),!0).forEach((function(t){Object(u["a"])(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var L={name:"ListProjectNamespace",components:{Masthead:g["a"],MoveModal:y["a"],ResourceTable:d["a"]},mixins:[N["a"]],props:{createProjectLocationOverride:{type:Object,default:function(){return null}},createNamespaceLocationOverride:{type:Object,default:function(){return null}}},fetch:function(){var e=this;return Object(l["a"])(m.a.mark((function t(){var r;return m.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r=e.$store.getters["currentStore"](v["A"]),e.schema=e.$store.getters["".concat(r,"/schemaFor")](v["A"]),e.projectSchema=e.$store.getters["management/schemaFor"](v["x"].PROJECT),e.schema){t.next=5;break}return t.abrupt("return");case 5:return t.next=7,e.$fetchType(v["A"]);case 7:return t.next=9,e.$store.dispatch("management/findAll",{type:v["x"].PROJECT,opt:{force:!0}});case 9:e.projects=t.sent;case 10:case"end":return t.stop()}}),t)})))()},data:function(){return{loadResources:[v["A"]],loadIndeterminate:!0,schema:null,projects:[],projectSchema:null,MANAGEMENT:v["x"],VIRTUAL_TYPES:v["Y"],defaultCreateProjectLocation:{name:"c-cluster-product-resource-create",params:{product:this.$store.getters["currentProduct"].name,resource:v["x"].PROJECT}}}},computed:A(A({},Object(f["b"])(["currentCluster","currentProduct"])),{},{namespaces:function(){var e=this.$store.getters["currentStore"](v["A"]);return this.$store.getters["".concat(e,"/all")](v["A"])},loading:function(){return!(!this.currentCluster||this.namespaces.length)&&this.$fetchState.pending},showIncrementalLoadingIndicator:function(){var e,t;return null===(e=this.perfConfig)||void 0===e||null===(t=e.incrementalLoading)||void 0===t?void 0:t.enabled},isNamespaceCreatable:function(){var e;return((null===(e=this.schema)||void 0===e?void 0:e.collectionMethods)||[]).includes("POST")},headers:function(){var e={name:"project",label:this.t("tableHeaders.project"),value:"project.nameDisplay",sort:["projectNameSort","nameSort"]};return[h["wb"],h["W"],"none"===this.groupPreference?e:null,h["b"]].filter((function(e){return e}))},projectIdsWithNamespaces:function(){var e=this.rows.map((function(e){return e.projectId})).filter((function(e){return e}));return Object(j["m"])(e)},clusterProjects:function(){var e,t,r=this.currentCluster.id,o=this.$store.getters["management/all"](v["x"].PROJECT);if(null!==(e=this.currentProduct)&&void 0!==e&&e.customNamespaceFilter&&null!==(t=this.currentProduct)&&void 0!==t&&t.inStore&&this.$store.getters["".concat(this.currentProduct.inStore,"/filterProject")])return this.$store.getters["".concat(this.currentProduct.inStore,"/filterProject")];var n=o.filter((function(e){return e.spec.clusterName===r}));return n},projectsWithoutNamespaces:function(){var e=this;return this.activeProjects.filter((function(t){return!e.projectIdsWithNamespaces.find((function(e){var r;return null===t||void 0===t||null===(r=t.id)||void 0===r?void 0:r.endsWith("/".concat(e))}))}))},rowsWithFakeNamespaces:function(){var e=this.projectsWithoutNamespaces.map((function(e){var t;return{groupByLabel:"resourceTable.groupLabel.notInAProject".concat("-",e.id),isFake:!0,mainRowKey:e.id,nameDisplay:null===(t=e.spec)||void 0===t?void 0:t.displayName,project:e,availableActions:[]}}));return this.showMockNotInProjectGroup&&e.push({groupByLabel:this.t("resourceTable.groupLabel.notInAProject"),mainRowKey:"fake-empty"}),[].concat(Object(i["a"])(this.rows),Object(i["a"])(e))},createProjectLocation:function(){return this.createProjectLocationOverride||this.defaultCreateProjectLocation},groupPreference:Object(P["mapPref"])(P["GROUP_RESOURCES"]),activeNamespaceFilters:function(){return this.$store.getters["activeNamespaceFilters"]},activeProjectFilters:function(){var e,t={},r=O(this.activeNamespaceFilters);try{for(r.s();!(e=r.n()).done;){var o=e.value,n=o.split("://",2),a=Object(s["a"])(n,2),c=a[0],i=a[1];"project"===c&&(t[i]=!0)}}catch(u){r.e(u)}finally{r.f()}return t},activeProjects:function(){var e=this,t=this.$store.getters["activeNamespaceFilters"];return t.includes(w["b"])&&0===Object.keys(this.activeProjectFilters).length?[]:this.userIsFilteringForSpecificNamespaceOrProject()?this.clusterProjects.filter((function(t){var r=t.id.split("/")[1];return!!e.activeProjectFilters[r]})):this.clusterProjects},activeNamespaces:function(){var e=this.$store.getters["namespaces"]();return this.namespaces.filter((function(t){return!!e[t.metadata.name]}))},filteredRows:function(){return"none"===this.groupPreference?this.rows:this.rowsWithFakeNamespaces},rows:function(){var e=this;return this.$store.getters["prefs/get"](P["ALL_NAMESPACES"])?this.activeNamespaces:this.activeNamespaces.filter((function(t){var r,o=e.$store.getters["systemNamespaces"].includes(t.metadata.name),n=t.isSystem||t.isFleetManaged||o;return null===(r=e.currentProduct)||void 0===r||!r.hideSystemResources||!n}))},canSeeProjectlessNamespaces:function(){return this.currentCluster.canUpdate},showMockNotInProjectGroup:function(){if(!this.canSeeProjectlessNamespaces)return!1;var e=!this.rows.some((function(e){return!e.project})),t=this.userIsFilteringForSpecificNamespaceOrProject();return!t&&e},notInProjectKey:function(){return this.$store.getters["i18n/t"]("resourceTable.groupLabel.notInAProject")}}),methods:{getPsaTooltip:function(e){var t=e.psaTooltipsDescription,r=Object.values(t).sort().map((function(e){return"<li>".concat(e,"</li>")})).join(""),o="<p>".concat(this.t("podSecurityAdmission.name"),": </p>");return"".concat(o,'<ul class="psa-tooltip">').concat(r,"</ul>")},userIsFilteringForSpecificNamespaceOrProject:function(){for(var e=this.$store.getters["namespaceFilters"],t=0;t<e.length;t++){var r=e[t],o=r.split("://")[0];if("ns"===o||"project"===o)return!0}return!1},slotName:function(e){return"main-row:".concat(e.id)},createNamespaceLocation:function(e){var t=e.rows[0].project,r=this.createNamespaceLocationOverride?A({},this.createNamespaceLocationOverride):{name:"c-cluster-product-resource-create",params:{product:this.$store.getters["currentProduct"].name,resource:v["A"]}};return r.query=Object(u["a"])({},b["x"],null===t||void 0===t?void 0:t.metadata.name),r},showProjectAction:function(e,t){var r=t.rows[0].project;this.$store.commit("action-menu/show",{resources:[r],elem:e.target})},showProjectActionButton:function(e){var t=e.rows[0].project;return!!t},projectLabel:function(e){var t,r=e.rows[0];return r.isFake?this.t("resourceTable.groupLabel.project",{name:null===(t=r.project)||void 0===t?void 0:t.nameDisplay},!0):r.groupByLabel},projectDescription:function(e){var t=e.rows[0].project;return null===t||void 0===t?void 0:t.description},clearSelection:function(){this.$refs.table.clearSelection()},sortGenerationFn:function(){var e=Object(d["b"])(this.schema,this.$store);return e+(this.showMockNotInProjectGroup?"-mock":"")}}},k=L,$=(r("96a3"),r("97db"),r("0c7c")),T=Object($["a"])(k,a,c,!1,null,"13d05b76",null),E=T.exports,x={components:{ExplorerProjectsNamespaces:E}},I=x,F=Object($["a"])(I,o,n,!1,null,null,null);t["default"]=F.exports}}]);
//# sourceMappingURL=projectsnamespaces.80975e76.js.map