(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages/c/_cluster/explorer/tools/index"],{"0fbb":function(t,e,r){},"3b42":function(t,e,r){"use strict";r("0fbb")},aedb:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return t.$fetchState.pending?r("Loading"):t.options.length?r("div",[r("h1",{domProps:{innerHTML:t._s(t.t("catalog.tools.header"))}}),t.legacyEnabled?t._e():r("TypeDescription",{attrs:{resource:"chart"}}),r("div",{staticClass:"grid"},t._l(t.options,(function(e){return r("div",{key:e.chart.id,staticClass:"item"},[r("div",{staticClass:"logo",class:{legacy:e.chart.legacy}},[e.chart.iconName?r("i",{staticClass:"icon",class:e.chart.iconName}):r("LazyImage",{attrs:{src:e.chart.icon}})],1),r("div",{staticClass:"name-version"},[r("div",[r("h3",{staticClass:"name"},[t._v(" "+t._s(e.chart.chartNameDisplay)+" ")]),e.chart.deploysOnWindows?r("label",{staticClass:"os-label"},[t._v(t._s(t.t("catalog.charts.deploysOnWindows")))]):t._e()]),r("div",{staticClass:"version"},[e.app&&e.app.upgradeAvailable?[t._v(" v"+t._s(e.app.currentVersion)+" "),r("b",[r("i",{staticClass:"icon icon-chevron-right"}),t._v(" v"+t._s(e.app.upgradeAvailable))])]:e.app?[t._v(" v"+t._s(e.app.currentVersion)+" ")]:e.chart.versions.length?[t._v(" v"+t._s(e.chart.versions[0].version)+" ")]:t._e()],2)]),r("div",{staticClass:"description"},[r("div",{staticClass:"description-content",domProps:{innerHTML:t._s(e.chart.chartDescription)}})]),e.app&&!e.chart.legacy?r("div",{staticClass:"state"},[r("AppSummaryGraph",{attrs:{row:e.app,"label-key":"generic.resourceCount","link-to":e.app.detailLocation}})],1):t._e(),r("div",{staticClass:"action"},[e.blocked?[r("button",{staticClass:"btn btn-sm role-primary",attrs:{disabled:"true"},domProps:{innerHTML:t._s(t.t("catalog.tools.action.install"))}})]:e.app&&e.chart.legacy?[r("button",{staticClass:"btn btn-sm role-secondary",domProps:{innerHTML:t._s(t.t("catalog.tools.action.manage"))},on:{click:function(r){return t.openV1Tool(e.chart.legacyPage)}}})]:e.app&&e.upgradeAvailable&&!e.chart.legacy?[r("button",{staticClass:"btn btn-sm role-secondary",on:{click:function(r){return t.remove(e.app,r)}}},[r("i",{staticClass:"icon icon-delete icon-lg"})]),r("button",{staticClass:"btn btn-sm role-secondary",domProps:{innerHTML:t._s(t.t("catalog.tools.action.upgrade"))},on:{click:function(r){return t.edit(e.app,e.app.upgradeAvailable)}}})]:e.app?[r("button",{staticClass:"btn btn-sm role-secondary",on:{click:function(r){return t.remove(e.app,r)}}},[r("i",{staticClass:"icon icon-delete icon-lg"})]),r("button",{staticClass:"btn btn-sm role-secondary",domProps:{innerHTML:t._s(t.t("catalog.tools.action.edit"))},on:{click:function(r){return t.edit(e.app)}}})]:e.chart.legacy?[r("button",{staticClass:"btn btn-sm role-primary",domProps:{innerHTML:t._s(t.t("catalog.tools.action.install"))},on:{click:function(r){return t.openV1Tool(e.chart.legacyPage)}}})]:[r("button",{staticClass:"btn btn-sm role-primary",domProps:{innerHTML:t._s(t.t("catalog.tools.action.install"))},on:{click:function(r){return t.install(e.chart)}}})]],2)])})),0)],1):r("div",[r("IconMessage",{attrs:{icon:"icon-warning","message-key":"catalog.tools.noTools"}})],1)},n=[],o=(r("1d8f"),r("13ec"),r("7e5b"),r("bcff"),r("b61e"),r("0b7a"),r("46d9"),r("a41c"),r("d323"),r("2869"),r("a797"),r("5986"),r("ade3")),c=r("1da1"),s=r("a34a"),i=r.n(s),l=(r("96cf"),r("8be0"),r("9d9d"),r("b667"),r("ddc0"),r("cf99"),r("2b77"),r("bb4d"),r("38aa"),r("2f62")),p=r("c778"),u=r("fa3b"),d=r("5ce5"),h=r("a788"),g=r("7388"),f=r("bc1c"),v=r("acf5"),b=r("b25d"),y=r("c2de"),m=r("1227"),C=r("2678"),A=r("35f4");function _(t,e){var r="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=w(t))||e&&t&&"number"===typeof t.length){r&&(t=r);var a=0,n=function(){};return{s:n,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,c=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return c=t.done,t},e:function(t){s=!0,o=t},f:function(){try{c||null==r.return||r.return()}finally{if(s)throw o}}}}function w(t,e){if(t){if("string"===typeof t)return O(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?O(t,e):void 0}}function O(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,a=new Array(e);r<e;r++)a[r]=t[r];return a}function P(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,a)}return r}function j(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?P(Object(r),!0).forEach((function(e){Object(o["a"])(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):P(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var k={components:{AppSummaryGraph:v["default"],LazyImage:f["a"],Loading:p["a"],IconMessage:C["a"],TypeDescription:A["a"]},fetch:function(){var t=this;return Object(c["a"])(i.a.mark((function e(){var r,a,n,o,c;return i.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$store.dispatch("catalog/load",{force:!0,reset:!0});case 2:return r=t.$route.query,e.next=5,t.$store.dispatch("management/findAll",{type:h["x"].PROJECT});case 5:return a=e.sent,t.showDeprecated=r[u["f"]]===u["M"],t.showHidden=r[u["o"]]===u["M"],e.next=10,t.$store.dispatch("cluster/findAll",{type:h["f"].APP});case 10:if(t.allInstalled=e.sent,!t.legacyEnabled){e.next=22;break}return e.next=14,t.$store.dispatch("management/findMatching",{type:h["x"].CATALOG_TEMPLATE,selector:"catalog.cattle.io/name=system-library"});case 14:if(n=e.sent,t.v1SystemCatalog=n?n.reduce((function(t,e){return t[e.spec.displayName]=e,t}),{}):{},o=a.find((function(t){var e;return"System"===(null===(e=t.spec)||void 0===e?void 0:e.displayName)})),!o){e.next=22;break}return c=o.id.replace("/",":"),t.systemProject=c,e.next=22,t.$store.dispatch("rancher/findAll",{type:h["D"].APP,opt:{url:"/v3/project/".concat(c,"/apps"),force:!0}});case 22:case"end":return e.stop()}}),e)})))()},data:function(){var t=this.$store.getters["features/get"](y["LEGACY"]);return{allInstalled:null,v1SystemCatalog:null,systemProject:null,legacyEnabled:t}},computed:j(j(j(j({},Object(l["b"])(["currentCluster"])),Object(l["b"])({allCharts:"catalog/charts",loadingErrors:"catalog/errors"})),Object(l["b"])({t:"i18n/t"})),{},{v1Apps:function(){return this.$store.getters["rancher/all"](h["D"].APP)},namespaces:function(){return this.$store.getters["activeNamespaceCache"]},rancherCatalog:function(){return this.$store.getters["catalog/repos"].find((function(t){return t.isRancher}))},installedApps:function(){return this.allInstalled},installedAppForChart:function(){var t,e={},r=_(this.installedApps);try{for(r.s();!(t=r.n()).done;){var a=t.value,n=a.matchingChart();n&&(e[n.id]=a)}}catch(o){r.e(o)}finally{r.f()}return e},options:function(){var t,e=this,r=this.currentCluster.status.provider||"other",a=this.allCharts||[],n=Object(d["filterAndArrangeCharts"])(a,{clusterProvider:r,showDeprecated:this.showDeprecated,showHidden:this.showHidden,showRepos:[null===(t=this.rancherCatalog)||void 0===t?void 0:t._key],showTypes:[g["e"]._CLUSTER_TOOL]});n=n.filter((function(t){return"Experimental"!==t.sideLabel})),this.legacyEnabled&&(n=n.concat(this.legacyCharts),n=Object(b["b"])(n,["certifiedSort","chartNameDisplay"]));var o=n.map((function(t){return{chart:t,app:e.installedAppForChart[t.id]}}));return this.legacyEnabled&&(o=this.checkLegacyApp(o,this.v1Apps,"v1-monitoring","rancher-monitoring","cluster-monitoring",!1),o=this.checkLegacyApp(o,this.v1Apps,"v1-istio","rancher-istio","cluster-istio",!0),o=this.checkLegacyApp(o,this.v1Apps,"v1-logging","rancher-logging","rancher-logging",!0)),o},legacyCharts:function(){return[this._legacyChart("monitoring"),this._legacyChart("logging"),this._legacyChart("istio")]}}),watch:{namespaces:function(){this.legacyEnabled&&this.systemProject&&this.$store.dispatch("rancher/findAll",{type:h["D"].APP,opt:{url:"/v3/project/".concat(this.systemProject,"/apps"),force:!0}})}},mounted:function(){window.c=this},methods:{_legacyChart:function(t){var e;return{certifiedSort:1,chartNameDisplay:this.t("v1ClusterTools.".concat(t,".label")),chartDescription:this.t("v1ClusterTools.".concat(t,".description")),id:"v1-".concat(t),chartName:"v1-".concat(t),key:"v1-".concat(t),versions:this.getLegacyVersions("rancher-".concat(t)),repoKey:null===(e=this.rancherCatalog)||void 0===e?void 0:e._key,legacy:!0,legacyPage:t,iconName:"icon-".concat(t)}},edit:function(t,e){t.goToUpgrade(e,!0)},remove:function(t,e){var r=Object(m["c"])(e);r?t.remove():t.promptRemove()},install:function(t){t.goToInstall(u["j"])},openV1Tool:function(t){var e=this.$store.getters["currentCluster"],r={name:"c-cluster-explorer-tools-pages-page",params:{cluster:e.id,product:"explorer",page:t}};this.$router.replace(r)},getLegacyVersions:function(t){var e,r,a=[],n=null===(e=this.v1SystemCatalog)||void 0===e?void 0:e[t];return null!==n&&void 0!==n&&null!==(r=n.spec)&&void 0!==r&&r.versions&&n.spec.versions.forEach((function(t){return a.push({version:t.version})})),a},checkLegacyApp:function(t,e,r,a,n,o){var c=t.find((function(t){return t.chart.chartName===r})),s=t.find((function(t){return t.chart.chartName===a}));if(c){var i,l=e.find((function(t){return t.id.indexOf(n)>0}));if(c.app=l,c.app){if(c.app.upgradeAvailable=void 0,null!==(i=c.chart.versions)&&void 0!==i&&i.length){var p,u=null===(p=c.chart.versions[0])||void 0===p?void 0:p.version;c.app.currentVersion!==u&&(c.app.upgradeAvailable=u)}}else o&&(t=t.filter((function(t){return t!==c})));s&&(c.app?(s.app=void 0,s.blocked=!0):s.app&&(c.blocked=!0))}return t}}},T=k,L=(r("3b42"),r("0c7c")),x=Object(L["a"])(T,a,n,!1,null,"0666ecb1",null);e["default"]=x.exports}}]);
//# sourceMappingURL=index.94d29aa6.js.map