(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages/c/_cluster/fleet/index"],{38526:function(e,t,o){},"950ac":function(e,t,o){"use strict";o("38526")},"98af":function(e,t,o){"use strict";o("d31a")},ba63:function(e,t,o){},c453:function(e,t,o){"use strict";o("ba63")},cc85b:function(e,t,o){"use strict";o.r(t);var s=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"fleet-dashboard"},[e.$fetchState.pending?o("Loading"):e.fleetWorkspacesData.length?e.gitRepos.length?o("div",{staticClass:"fleet-dashboard-data"},[o("div",{staticClass:"title"},[o("h1",[o("t",{attrs:{k:"fleet.dashboard.pageTitle"}})],1),o("div",[e.areAllCardsExpanded?o("p",{on:{click:function(t){return e.toggleAll("collapse")}}},[e._v(" "+e._s(e.t("fleet.dashboard.collapseAll"))+" ")]):o("p",{on:{click:function(t){return e.toggleAll("expand")}}},[e._v(" "+e._s(e.t("fleet.dashboard.expandAll"))+" ")])])]),e.emptyWorkspaces.length?o("div",{staticClass:"title-footnote"},[o("p",[e._v(e._s(e.t("fleet.dashboard.thereIsMore",{count:e.emptyWorkspaces.length}))+": ")]),e._l(e.emptyWorkspaces,(function(t,s){return o("p",{key:s},[e._v(" "+e._s(t.nameDisplay)),s!=e.emptyWorkspaces.length-1?o("span",[e._v(", ")]):e._e()])}))],2):e._e(),e._l(e.workspacesData,(function(t){return o("CollapsibleCard",{key:t.id,staticClass:"mt-20 mb-40",attrs:{title:e.t("resourceDetail.masthead.workspace")+": "+t.nameDisplay,"is-collapsed":e.isCollapsed[t.id],"is-title-clickable":!0},on:{toggleCollapse:function(o){return e.toggleCollapse(o,t.id)},titleClick:function(o){return e.setWorkspaceFilterAndLinkToGitRepo(t.id)}},scopedSlots:e._u([{key:"header-right",fn:function(){return[o("div",{staticClass:"header-icons"},[o("p",[o("i",{staticClass:"icon icon-repository"}),o("span",[e._v(e._s(e.t("tableHeaders.repositories"))+": "),o("span",[e._v(e._s(t.counts.gitRepos))])])]),o("p",[o("i",{staticClass:"icon icon-storage"}),o("span",[e._v(e._s(e.t("tableHeaders.clusters"))+": "),o("span",[e._v(e._s(t.counts.clusters))])])]),o("p",[o("i",{staticClass:"icon icon-folder"}),o("span",[e._v(e._s(e.t("tableHeaders.clusterGroups"))+": "),o("span",[e._v(e._s(t.counts.clusterGroups))])])])])]},proxy:!0},{key:"content",fn:function(){return[o("ResourceTable",e._g(e._b({attrs:{schema:e.schema,headers:e.headers,rows:t.repos,"key-field":"_key",search:!1,"table-actions":!1},scopedSlots:e._u([{key:"cell:clustersReady",fn:function(s){var a=s.row;return["namespace"===t.type?o("span",[e._v(" - ")]):o("CompoundStatusBadge",{attrs:{"tooltip-text":e.getTooltipInfo("clusters",a),"badge-class":e.getStatusInfo("clusters",a).badgeClass,icon:e.getStatusInfo("clusters",a).icon,value:a.clusterInfo.ready+"/"+a.clusterInfo.total}})]}},{key:"cell:bundlesReady",fn:function(s){var a=s.row;return["namespace"===t.type?o("span",[e._v(" - ")]):o("CompoundStatusBadge",{attrs:{"tooltip-text":e.getTooltipInfo("bundles",a),"badge-class":e.getStatusInfo("bundles",a).badgeClass,icon:e.getStatusInfo("bundles",a).icon,value:(a.bundlesReady.length||0)+"/"+a.bundles.length}})]}},{key:"cell:resourcesReady",fn:function(t){var s=t.row;return[o("CompoundStatusBadge",{attrs:{"tooltip-text":e.getTooltipInfo("resources",s),"badge-class":e.getStatusInfo("resources",s).badgeClass,icon:e.getStatusInfo("resources",s).icon,value:s.status.resourceCounts.ready+"/"+s.status.resourceCounts.desiredReady}})]}},{key:"cell:target",fn:function(t){var o=t.row;return[e._v(" "+e._s(o.targetInfo.modeDisplay)+" ")]}}],null,!0)},"ResourceTable",e.$attrs,!1),e.$listeners))]},proxy:!0}],null,!0)})}))],2):o("div",{staticClass:"fleet-empty-dashboard"},[o("i",{staticClass:"icon-fleet mb-30"}),o("h1",[e._v(e._s(e.t("fleet.dashboard.welcome")))]),o("p",{staticClass:"mb-30"},[o("span",[e._v(e._s(e.t("fleet.dashboard.gitOpsScale")))]),o("a",{attrs:{href:e.t("fleet.dashboard.learnMoreLink"),target:"_blank",rel:"noopener noreferrer nofollow"}},[e._v(" "+e._s(e.t("fleet.dashboard.learnMore"))+" "),o("i",{staticClass:"icon icon-external-link"})])]),o("h3",{staticClass:"mb-30"},[e._v(" "+e._s(e.t("fleet.dashboard.noRepo",null,!0))+" ")]),o("n-link",{staticClass:"btn role-secondary",attrs:{to:e.getStartedLink}},[e._v(" "+e._s(e.t("fleet.dashboard.getStarted"))+" ")])],1):o("FleetNoWorkspaces",{attrs:{"can-view":e.permissions.workspaces}})],1)},a=[],n=(o("13ec"),o("7e5b"),o("bcff"),o("ade3")),l=o("1da1"),r=(o("bb4d"),o("cf99"),o("8be0"),o("1d8f"),o("2b77"),o("38aa"),o("a34a")),c=o.n(r),i=(o("96cf"),o("2f62")),u=o("a788"),d=o("e528"),p=o("15cb"),b=o("c778"),f=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"collapsible-card",class:{isCollapsed:e.isCollapsed}},[o("div",{staticClass:"collapsible-card-header",on:{click:e.toggleCollapse}},[o("h2",{staticClass:"mb-0"},[o("span",{class:{isTitleClickable:e.isTitleClickable},on:{click:e.titleClick}},[e._v(e._s(e.title))])]),o("div",[e._t("header-right"),o("i",{staticClass:"collapsible-card-collapse-icon",class:{"icon-chevron-up":!e.isCollapsed,"icon-chevron-down":e.isCollapsed}})],2)]),o("div",{staticClass:"collapsible-card-body"},[e._t("content")],2)])},v=[],g={name:"CollapsibleCard",props:{isCollapsed:{type:Boolean,default:!1},title:{type:String,default:""},isTitleClickable:{type:Boolean,default:!1}},methods:{toggleCollapse:function(){this.$emit("toggleCollapse",!this.isCollapsed)},titleClick:function(e){this.isTitleClickable&&(e.stopPropagation(),this.$emit("titleClick"))}}},m=g,C=(o("c453"),o("0c7c")),h=Object(C["a"])(m,f,v,!1,null,"1e5e5c84",null),y=h.exports,_=o("b178"),R=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{directives:[{name:"tooltip",rawName:"v-tooltip.bottom",value:e.tooltipText,expression:"tooltipText",modifiers:{bottom:!0}}],staticClass:"compound-cluster-badge",class:"bg-"+e.badgeClass},[e.icon?o("i",{class:"icon-"+e.icon}):e._e(),o("span",[e._v(e._s(e.value))])])},I=[],E={name:"CompoundStatusBadge",props:{tooltipText:{type:String,default:""},badgeClass:{type:String,default:""},icon:{type:String,default:""},value:{type:String,default:""}}},k=E,O=(o("950ac"),Object(C["a"])(k,R,I,!1,null,"65b93abc",null)),N=O.exports,T=o("c47f"),A=o("7388"),D=o("f303"),w=o("32cb"),P=o("ee21");function W(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,s)}return o}function S(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?W(Object(o),!0).forEach((function(t){Object(n["a"])(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):W(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var L={name:"ListGitRepo",components:{Loading:b["a"],ResourceTable:_["a"],CollapsibleCard:y,CompoundStatusBadge:N,FleetNoWorkspaces:w["a"]},fetch:function(){var e=this;return Object(l["a"])(c.a.mark((function t(){var o,s;return c.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(T["c"])({fleetWorkspaces:{inStoreType:"management",type:u["n"].WORKSPACE,schemaValidator:function(e){var t;return!(null===e||void 0===e||null===(t=e.links)||void 0===t||!t.collection)}},allBundles:{inStoreType:"management",type:u["n"].BUNDLE},gitRepos:{inStoreType:"management",type:u["n"].GIT_REPO}},e.$store);case 2:return o=t.sent,e.gitRepos=o.gitRepos,e.fleetWorkspacesData=o.fleetWorkspaces||[],t.prev=5,t.next=8,Object(T["b"])({workspaces:{type:u["n"].WORKSPACE},gitRepos:{type:u["n"].GIT_REPO}},e.$store.getters);case 8:s=t.sent,e.permissions=s,t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](5),console.error(t.t0);case 15:case"end":return t.stop()}}),t,null,[[5,12]])})))()},data:function(){return{headers:[{name:"name",labelKey:"tableHeaders.repoName",value:"nameDisplay",sort:["nameSort"],formatter:"LinkDetail",canBeVariable:!0},{name:"clustersReady",labelKey:"tableHeaders.clustersReady",value:"status.readyClusters",sort:"status.readyClusters",search:!1},{name:"bundlesReady",labelKey:"tableHeaders.bundlesReady",value:"status.readyClusters",sort:"status.readyClusters",search:!1},{name:"resourcesReady",labelKey:"tableHeaders.resourcesReady",value:"status.resourceCounts.ready",sort:"status.resourceCounts.ready"}],schema:{},allBundles:[],gitRepos:[],fleetWorkspacesData:[],isCollapsed:{},permissions:{},getStartedLink:{name:"c-cluster-product-resource-create",params:{product:P["NAME"],resource:u["n"].GIT_REPO}}}},computed:S(S({},Object(i["c"])(["workspace","allNamespaces"])),{},{fleetWorkspaces:function(){var e,t=this;return null!==(e=this.fleetWorkspacesData)&&void 0!==e&&e.length?this.fleetWorkspacesData:this.allNamespaces.filter((function(e){return e.metadata.annotations[A["I"]]===d["WORKSPACE"]})).map((function(e){var o=Object(D["d"])(t.gitRepos,"metadata.namespace",e.id);return S(S({},e),{},{counts:{clusters:"-",clusterGroups:"-",gitRepos:o.length},repos:o,nameDisplay:e.id})}))},workspacesData:function(){return this.fleetWorkspaces.filter((function(e){return e.repos&&e.repos.length}))},emptyWorkspaces:function(){return this.fleetWorkspaces.filter((function(e){return!e.repos||!e.repos.length}))},areAllCardsExpanded:function(){var e=this;return Object.keys(this.isCollapsed).every((function(t){return!e.isCollapsed[t]}))}}),methods:{setWorkspaceFilterAndLinkToGitRepo:function(e){this.$store.commit("updateWorkspace",{value:e,getters:this.$store.getters}),this.$store.dispatch("prefs/set",{key:d["WORKSPACE"],value:e}),this.$router.push({name:"c-cluster-product-resource",params:{product:P["NAME"],resource:u["n"].GIT_REPO}})},getStatusInfo:function(e,t){var o,s,a,n,l,r,c,i,u,d,b,f,v,g,m,C,h,y,_,R,I,E,k,O,N,T,A,D,w,P;switch(e){case"clusters":return(null===(o=t.clusterInfo)||void 0===o?void 0:o.ready)===(null===(s=t.clusterInfo)||void 0===s?void 0:s.total)&&null!==(a=t.clusterInfo)&&void 0!==a&&a.ready?{badgeClass:p["a"][p["b"].ACTIVE].color,icon:p["a"][p["b"].ACTIVE].compoundIcon}:{badgeClass:"".concat(p["a"][p["b"].NOT_READY].color," badge-class-area-clusters"),icon:p["a"][p["b"].NOT_READY].compoundIcon};case"bundles":return null!==(n=t.bundles)&&void 0!==n&&n.length&&null!==(l=t.bundles)&&void 0!==l&&l.every((function(e){var t;return(null===(t=e.state)||void 0===t?void 0:t.toLowerCase())===p["b"].ACTIVE}))?{badgeClass:p["a"][p["b"].ACTIVE].color?p["a"][p["b"].ACTIVE].color:"".concat(p["a"][p["b"].UNKNOWN].color," bg-unmapped-state"),icon:p["a"][p["b"].ACTIVE].compoundIcon?p["a"][p["b"].ACTIVE].compoundIcon:"".concat(p["a"][p["b"].UNKNOWN].compoundIcon," unmapped-icon")}:null!==(r=t.bundles)&&void 0!==r&&r.length&&null!==(c=t.bundles)&&void 0!==c&&c.some((function(e){var t;return(null===(t=e.state)||void 0===t?void 0:t.toLowerCase())===p["b"].ERR_APPLIED}))?{badgeClass:p["a"][p["b"].ERR_APPLIED].color?p["a"][p["b"].ERR_APPLIED].color:"".concat(p["a"][p["b"].UNKNOWN].color," bg-unmapped-state"),icon:p["a"][p["b"].ERR_APPLIED].compoundIcon?p["a"][p["b"].ERR_APPLIED].compoundIcon:"".concat(p["a"][p["b"].UNKNOWN].compoundIcon," unmapped-icon")}:null!==(i=t.bundles)&&void 0!==i&&i.length&&null!==(u=t.bundles)&&void 0!==u&&u.some((function(e){var t;return(null===(t=e.state)||void 0===t?void 0:t.toLowerCase())===p["b"].NOT_READY}))?{badgeClass:p["a"][p["b"].NOT_READY].color?p["a"][p["b"].NOT_READY].color:"".concat(p["a"][p["b"].UNKNOWN].color," bg-unmapped-state"),icon:p["a"][p["b"].NOT_READY].compoundIcon?p["a"][p["b"].NOT_READY].compoundIcon:"".concat(p["a"][p["b"].UNKNOWN].compoundIcon," unmapped-icon")}:(null===(d=t.bundlesReady)||void 0===d?void 0:d.length)===(null===(b=t.bundles)||void 0===b?void 0:b.length)&&t.bundlesReady&&null!==(f=t.bundles)&&void 0!==f&&f.length?{badgeClass:p["a"][p["b"].ACTIVE].color,icon:p["a"][p["b"].ACTIVE].compoundIcon}:{badgeClass:"".concat(p["a"][p["b"].NOT_READY].color," badge-class-area-bundles"),icon:p["a"][p["b"].NOT_READY].compoundIcon};case"resources":return null!==(v=t.status)&&void 0!==v&&null!==(g=v.resources)&&void 0!==g&&g.length&&null!==(m=t.status)&&void 0!==m&&null!==(C=m.resources)&&void 0!==C&&C.every((function(e){var t;return(null===(t=e.state)||void 0===t?void 0:t.toLowerCase())===p["b"].ACTIVE}))?{badgeClass:p["a"][p["b"].ACTIVE].color?p["a"][p["b"].ACTIVE].color:"".concat(p["a"][p["b"].UNKNOWN].color," bg-unmapped-state"),icon:p["a"][p["b"].ACTIVE].compoundIcon?p["a"][p["b"].ACTIVE].compoundIcon:"".concat(p["a"][p["b"].UNKNOWN].compoundIcon," unmapped-icon")}:null!==(h=t.status)&&void 0!==h&&null!==(y=h.resources)&&void 0!==y&&y.length&&null!==(_=t.status)&&void 0!==_&&null!==(R=_.resources)&&void 0!==R&&R.some((function(e){var t;return(null===(t=e.state)||void 0===t?void 0:t.toLowerCase())===p["b"].ERR_APPLIED}))?{badgeClass:p["a"][p["b"].ERR_APPLIED].color?p["a"][p["b"].ERR_APPLIED].color:"".concat(p["a"][p["b"].UNKNOWN].color," bg-unmapped-state"),icon:p["a"][p["b"].ERR_APPLIED].compoundIcon?p["a"][p["b"].ERR_APPLIED].compoundIcon:"".concat(p["a"][p["b"].UNKNOWN].compoundIcon," unmapped-icon")}:null!==(I=t.status)&&void 0!==I&&null!==(E=I.resources)&&void 0!==E&&E.length&&null!==(k=t.status)&&void 0!==k&&null!==(O=k.resources)&&void 0!==O&&O.some((function(e){var t;return(null===(t=e.state)||void 0===t?void 0:t.toLowerCase())===p["b"].NOT_READY}))?{badgeClass:p["a"][p["b"].NOT_READY].color?p["a"][p["b"].NOT_READY].color:"".concat(p["a"][p["b"].UNKNOWN].color," bg-unmapped-state"),icon:p["a"][p["b"].NOT_READY].compoundIcon?p["a"][p["b"].NOT_READY].compoundIcon:"".concat(p["a"][p["b"].UNKNOWN].compoundIcon," unmapped-icon")}:(null===(N=t.status)||void 0===N||null===(T=N.resourceCounts)||void 0===T?void 0:T.desiredReady)===(null===(A=t.status)||void 0===A||null===(D=A.resourceCounts)||void 0===D?void 0:D.ready)&&null!==(w=t.status)&&void 0!==w&&null!==(P=w.resourceCounts)&&void 0!==P&&P.desiredReady?{badgeClass:p["a"][p["b"].ACTIVE].color,icon:p["a"][p["b"].ACTIVE].compoundIcon}:{badgeClass:"".concat(p["a"][p["b"].NOT_READY].color," badge-class-area-resources"),icon:p["a"][p["b"].NOT_READY].compoundIcon};default:return{badgeClass:"".concat(p["a"][p["b"].NOT_READY].color," badge-class-default"),icon:p["a"][p["b"].NOT_READY].compoundIcon}}},getTooltipInfo:function(e,t){var o,s,a,n;switch(e){case"clusters":var l,r;return null!==(o=t.clusterInfo)&&void 0!==o&&o.total?"Ready: ".concat(null===(l=t.clusterInfo)||void 0===l?void 0:l.ready,"<br>Total: ").concat(null===(r=t.clusterInfo)||void 0===r?void 0:r.total):"";case"bundles":return null!==(s=t.bundles)&&void 0!==s&&s.length?this.generateTooltipData(t.bundles):"";case"resources":var c;return null!==(a=t.status)&&void 0!==a&&null!==(n=a.resources)&&void 0!==n&&n.length?this.generateTooltipData(null===(c=t.status)||void 0===c?void 0:c.resources):"";default:return{}}},generateTooltipData:function(e){var t={},o="";return e.forEach((function(e){t[e.state]||(t[e.state]=0),t[e.state]++})),Object.keys(t).forEach((function(e){o+="".concat(Object(p["e"])(e),": ").concat(t[e],"<br>")})),o},toggleCollapse:function(e,t){this.$set(this.isCollapsed,t,e)},toggleAll:function(e){var t=this,o="expand"!==e;Object.keys(this.isCollapsed).forEach((function(e){t.$set(t.isCollapsed,e,o)}))}},watch:{fleetWorkspaces:function(e){var t=this;null===e||void 0===e||e.filter((function(e){var t;return null===(t=e.repos)||void 0===t?void 0:t.length})).forEach((function(e){t.$set(t.isCollapsed,e.id,!1)}))}}},j=L,x=(o("98af"),Object(C["a"])(j,s,a,!1,null,"4777fd0c",null));t["default"]=x.exports},d31a:function(e,t,o){}}]);
//# sourceMappingURL=index.257837cb.js.map