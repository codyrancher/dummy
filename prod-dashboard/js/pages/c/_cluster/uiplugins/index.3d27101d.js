(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages/c/_cluster/uiplugins/index","pages/c/_cluster/uiplugins/DeveloperInstallDialog","pages/c/_cluster/uiplugins/InstallDialog","pages/c/_cluster/uiplugins/PluginInfoPanel","pages/c/_cluster/uiplugins/RemoveUIPlugins","pages/c/_cluster/uiplugins/SetupUIPlugins","pages/c/_cluster/uiplugins/UninstallDialog"],{"093f":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Dialog",{attrs:{name:"confirm-uiplugins-remove",title:e.t("plugins.setup.remove.title"),mode:"disable","data-testid":"disable-ext-modal"},on:{okay:e.doRemove}},[[n("p",[e._v(" "+e._s(e.t("plugins.setup.remove.prompt"))+" ")]),e.defaultRepo?n("div",{staticClass:"mt-20"},[n("Checkbox",{attrs:{primary:!0,"label-key":"plugins.setup.remove.registry.title","data-testid":"disable-ext-modal-remove-repo"},model:{value:e.removeRepo,callback:function(t){e.removeRepo=t},expression:"removeRepo"}}),n("div",{staticClass:"checkbox-info"},[e._v(" "+e._s(e.t("plugins.setup.remove.registry.prompt"))+" ")])],1):e._e(),e.hasPluginsInstalled?n("div",{staticClass:"mt-20"},[n("Checkbox",{attrs:{primary:!0,"label-key":"plugins.setup.remove.crd.title"},model:{value:e.removeCRD,callback:function(t){e.removeCRD=t},expression:"removeCRD"}}),n("div",{staticClass:"checkbox-info"},[e._v(" "+e._s(e.t("plugins.setup.remove.crd.prompt"))+" ")])],1):e._e()]],2)},i=[],s=n("2909"),r=n("1da1"),l=n("a34a"),o=n.n(l),c=(n("96cf"),n("9d9d"),n("8be0"),n("0b7a"),n("e673"),n("cf99"),n("a788")),u=n("e5e4"),d=n("bd30"),p=n("7600"),v={components:{Checkbox:d["a"],Dialog:u["a"]},fetch:function(){var e=this;return Object(r["a"])(o.a.mark((function t(){var n,a;return o.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.$store.getters["management/schemaFor"](c["f"].CLUSTER_REPO)){t.next=5;break}return t.next=3,e.$store.dispatch("management/findAll",{type:c["f"].CLUSTER_REPO,opt:{force:!0}});case 3:n=t.sent,e.defaultRepo=n.find((function(e){return e.name===p["b"]&&e.spec.gitRepo===p["c"]}));case 5:if(!e.$store.getters["management/schemaFor"](c["W"])){t.next=11;break}return t.next=8,e.$store.dispatch("management/findAll",{type:c["W"]});case 8:a=t.sent,e.hasPluginsInstalled=(a||[]).length>0,e.removeCRD=!e.hasPluginsInstalled;case 11:case"end":return t.stop()}}),t)})))()},data:function(){return{errors:[],defaultRepo:void 0,removeRepo:!1,removeCRD:!0,hasPluginsInstalled:!1}},methods:{removeChart:function(e){var t=this;return Object(r["a"])(o.a.mark((function n(){var a,i;return o.a.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.$store.dispatch("management/findAll",{type:c["f"].APP});case 2:if(a=n.sent,i=a.find((function(t){return t.namespace===p["g"]&&t.name===e})),!i){n.next=6;break}return n.abrupt("return",i.remove());case 6:return n.abrupt("return",Promise.reject(new Error("Could not find chart ยง{ name }")));case 7:case"end":return n.stop()}}),n)})))()},showDialog:function(){this.removeRepo=!!this.defaultRepo,this.$modal.show("confirm-uiplugins-remove")},doRemove:function(e){var t=this;return Object(r["a"])(o.a.mark((function n(){var a,i,r;return o.a.wrap((function(n){while(1)switch(n.prev=n.next){case 0:t.errors=[],a=Object(s["a"])(p["e"]).reverse(),t.removeCRD||(a=a.filter((function(e){return e!==p["h"]}))),i=0;case 4:if(!(i<a.length)){n.next=17;break}return r=a[i],n.prev=6,n.next=9,t.removeChart(r);case 9:n.next=14;break;case 11:n.prev=11,n.t0=n["catch"](6),t.errors.push(n.t0.message);case 14:i++,n.next=4;break;case 17:if(!t.removeRepo||!t.defaultRepo){n.next=26;break}return n.prev=18,n.next=21,t.defaultRepo.remove();case 21:n.next=26;break;case 23:n.prev=23,n.t1=n["catch"](18),t.errors.push(n.t1.message);case 26:return t.$store.dispatch("management/forgetType",c["W"]),n.next=29,new Promise((function(e){return setTimeout(e,5e3)}));case 29:t.$emit("done"),e(!0);case 31:case"end":return n.stop()}}),n,null,[[6,11],[18,23]])})))()}}},g=v,f=(n("d3f4"),n("0c7c")),m=Object(f["a"])(g,a,i,!1,null,"e4a36550",null);t["default"]=m.exports},"10dd":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"plugins"},[n("div",{staticClass:"plugin-header"},[n("h2",{attrs:{"data-testid":"extensions-page-title"}},[e._v(" "+e._s(e.t("plugins.title"))+" ")]),e.reloadRequired?n("div",{staticClass:"plugin-reload-banner mr-20",attrs:{"data-testid":"extension-reload-banner"}},[n("i",{staticClass:"icon icon-checkmark mr-10"}),n("span",[e._v(" "+e._s(e.t("plugins.reload"))+" ")]),n("button",{staticClass:"ml-10 btn btn-sm role-primary",attrs:{"data-testid":"extension-reload-banner-reload-btn"},on:{click:function(t){return e.reload()}}},[e._v(" "+e._s(e.t("generic.reload"))+" ")])]):e._e(),e.hasService&&e.hasMenuActions?n("button",{ref:"actions",staticClass:"btn actions role-secondary",attrs:{"aria-haspopup":"true",type:"button","data-testid":"extensions-page-menu"},on:{click:e.setMenu}},[n("i",{staticClass:"icon icon-actions"})]):e._e(),e.hasService&&e.hasMenuActions?n("ActionMenu",{attrs:{"custom-actions":e.menuActions,open:e.menuOpen,"use-custom-target-element":!0,"custom-target-element":e.menuTargetElement,"custom-target-event":e.menuTargetEvent},on:{close:function(t){return e.setMenu(!1)},devLoad:e.showDeveloperLoaddDialog,removePluginSupport:e.removePluginSupport,manageRepos:e.manageRepos}}):e._e()],1),n("PluginInfoPanel",{ref:"infoPanel"}),e.hasService?n("div",[n("Tabbed",{ref:"tabs",attrs:{"tabs-only":!0,"data-testid":"extension-tabs"},on:{changed:e.filterChanged}},[n("Tab",{attrs:{name:"installed","data-testid":"extension-tab-installed","label-key":"plugins.tabs.installed",weight:20}}),n("Tab",{attrs:{name:"available","data-testid":"extension-tab-available","label-key":"plugins.tabs.available",weight:19}}),n("Tab",{attrs:{name:"updates","label-key":"plugins.tabs.updates",weight:18,badge:e.updates.length}}),n("Tab",{attrs:{name:"all","label-key":"plugins.tabs.all",weight:17}})],1),e.loading?n("div",{staticClass:"data-loading"},[n("i",{staticClass:"icon-spin icon icon-spinner"}),n("t",{attrs:{k:"generic.loading",raw:!0}})],1):n("div",{staticClass:"plugin-list",class:{"v-margin":!e.list.length}},[0===e.list.length?n("IconMessage",{attrs:{vertical:!0,subtle:!0,icon:"icon-extension",message:e.emptyMessage}}):e._l(e.list,(function(t){return n("div",{key:t.name,staticClass:"plugin",attrs:{"data-testid":"extension-card-"+t.name},on:{click:function(n){return e.showPluginDetail(t)}}},[n("div",{staticClass:"plugin-icon",class:e.applyDarkModeBg},[t.icon?n("LazyImage",{staticClass:"icon plugin-icon-img",attrs:{"initial-src":e.defaultIcon,"error-src":e.defaultIcon,src:t.icon}}):n("img",{staticClass:"icon plugin-icon-img",attrs:{src:e.defaultIcon}})],1),n("div",{staticClass:"plugin-metadata"},[n("div",{staticClass:"plugin-name"},[e._v(" "+e._s(t.label)+" ")]),n("div",[e._v(e._s(t.description))]),n("div",{staticClass:"plugin-version"},[t.installing?n("span",{staticClass:"plugin-installing"},[e._v(" - ")]):n("span",[n("span",[e._v(e._s(t.displayVersion))]),t.upgrade?n("span",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.t("plugins.upgradeAvailable"),expression:"t('plugins.upgradeAvailable')"}]},[e._v(" -> "+e._s(t.upgrade))]):e._e(),t.incompatibleDisclaimer?n("p",{staticClass:"incompatible"},[e._v(e._s(t.incompatibleDisclaimer))]):e._e()])]),t.builtin?n("div",{staticClass:"plugin-badges"},[n("div",{staticClass:"plugin-builtin"},[e._v(" "+e._s(e.t("plugins.labels.builtin"))+" ")])]):n("div",{staticClass:"plugin-badges"},[t.certified?e._e():n("div",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.t("plugins.descriptions.third-party"),expression:"t('plugins.descriptions.third-party')"}]},[e._v(" "+e._s(e.t("plugins.labels.third-party"))+" ")]),t.experimental?n("div",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.t("plugins.descriptions.experimental"),expression:"t('plugins.descriptions.experimental')"}]},[e._v(" "+e._s(e.t("plugins.labels.experimental"))+" ")]):e._e()]),n("div",{staticClass:"plugin-spacer"}),n("div",{staticClass:"plugin-actions"},[t.error?[n("div",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.error,expression:"plugin.error"}],staticClass:"plugin-error"},[n("i",{staticClass:"icon icon-warning"})])]:e._e(),t.helmError?n("div",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.t("plugins.helmError"),expression:"t('plugins.helmError')"}],staticClass:"plugin-error"},[n("i",{staticClass:"icon icon-warning"})]):e._e(),n("div",{staticClass:"plugin-spacer"}),t.installing?n("div",{staticClass:"plugin-installing"},[n("i",{staticClass:"version-busy icon icon-spin icon-spinner"}),"install"===t.installing?n("div",[e._v(" "+e._s(e.t("plugins.labels.installing"))+" ")]):n("div",[e._v(" "+e._s(e.t("plugins.labels.uninstalling"))+" ")])]):t.installed?n("div",{staticClass:"plugin-buttons"},[t.builtin?e._e():n("button",{staticClass:"btn role-secondary",attrs:{"data-testid":"extension-card-uninstall-btn-"+t.name},on:{click:function(n){return e.showUninstallDialog(t,n)}}},[e._v(" "+e._s(e.t("plugins.uninstall.label"))+" ")]),t.upgrade?n("button",{staticClass:"btn role-secondary",attrs:{"data-testid":"extension-card-update-btn-"+t.name},on:{click:function(n){return e.showInstallDialog(t,"update",n)}}},[e._v(" "+e._s(e.t("plugins.update.label"))+" ")]):e._e(),!t.upgrade&&t.installableVersions&&t.installableVersions.length>1?n("button",{staticClass:"btn role-secondary",attrs:{"data-testid":"extension-card-rollback-btn-"+t.name},on:{click:function(n){return e.showInstallDialog(t,"rollback",n)}}},[e._v(" "+e._s(e.t("plugins.rollback.label"))+" ")]):e._e()]):n("div",{staticClass:"plugin-buttons"},[n("button",{staticClass:"btn role-secondary",attrs:{"data-testid":"extension-card-install-btn-"+t.name},on:{click:function(n){return e.showInstallDialog(t,"install",n)}}},[e._v(" "+e._s(e.t("plugins.install.label"))+" ")])])],2)])])}))],2)],1):n("div",[e.loading?n("div",{staticClass:"data-loading"},[n("i",{staticClass:"icon-spin icon icon-spinner"}),n("t",{attrs:{k:"generic.loading",raw:!0}})],1):n("SetupUIPlugins",{staticClass:"setup-message",on:{done:e.updateInstallStatus}})],1),n("InstallDialog",{ref:"installDialog",on:{closed:e.didInstall,update:e.updatePluginInstallStatus}}),n("UninstallDialog",{ref:"uninstallDialog",on:{closed:e.didUninstall,update:e.updatePluginInstallStatus}}),n("DeveloperInstallDialog",{ref:"developerInstallDialog",on:{closed:e.didInstall}}),n("RemoveUIPlugins",{ref:"removeUIPlugins",on:{done:e.updateInstallStatus}})],1)},i=[],s=(n("7e5b"),n("bcff"),n("53ca")),r=n("2909"),l=n("ade3"),o=n("1da1"),c=n("a34a"),u=n.n(c),d=(n("96cf"),n("4d7f"),n("cf99"),n("8be0"),n("bb4d"),n("9d9d"),n("0b7a"),n("38aa"),n("13ec"),n("d323"),n("2b77"),n("1d8f"),n("2b0e")),p=n("2f62"),v=n("e528"),g=n("b25d"),f=n("fa98"),m=n("a788"),h=n("ac98"),b=n("7388"),_=n("959a"),y=n("1ffb"),C=n("a4d2"),x=n("f38f"),w=n("2678"),O=n("bc1c"),k=n("94af"),I=n("28f0"),P=n("9744"),D=n("b4b2"),E=n("c150"),R=n("093f"),j=n("7600");function $(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$(Object(n),!0).forEach((function(t){Object(l["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var N=200,T={components:{ActionMenu:y["a"],DeveloperInstallDialog:P["default"],IconMessage:w["a"],InstallDialog:I["default"],LazyImage:O["a"],PluginInfoPanel:D["default"],Tab:x["a"],Tabbed:C["a"],UninstallDialog:k["default"],SetupUIPlugins:E["default"],RemoveUIPlugins:R["default"]},data:function(){var e;return{view:"",charts:[],installing:{},errors:{},plugins:[],helmOps:[],loading:!0,menuTargetElement:null,menuTargetEvent:null,menuOpen:!1,hasService:!1,defaultIcon:n("53a6"),reloadRequired:!1,rancherVersion:null===(e=Object(h["a"])())||void 0===e?void 0:e.Version}},layout:"plain",fetch:function(){var e=this;return Object(o["a"])(u.a.mark((function t(){var n,a,i,s,r;return u.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n={},t.next=3,e.updateInstallStatus();case 3:return a=t.sent,a&&e.$store.getters["management/schemaFor"](m["W"])&&(n.plugins=e.$store.dispatch("management/findAll",{type:m["W"]})),t.next=7,e.$store.dispatch("catalog/load");case 7:if(n.load=t.sent,!e.$store.getters["management/schemaFor"](m["f"].OPERATION)){t.next=12;break}return t.next=11,e.$store.dispatch("management/findAll",{type:m["f"].OPERATION});case 11:n.helmOps=t.sent;case 12:return t.next=14,Object(f["a"])(n);case 14:i=t.sent,e.plugins=i.plugins||[],e.helmOps=i.helmOps||[],s=e.$store.getters["catalog/rawCharts"],e.charts=Object.values(s),0===e.plugins.length&&(null===(r=e.$refs.tabs)||void 0===r||r.select("available")),e.loading=!1;case 21:case"end":return t.stop()}}),t)})))()},computed:S(S(S(S({pluginDeveloper:Object(v["mapPref"])(v["PLUGIN_DEVELOPER"])},Object(p["b"])({uiplugins:"uiplugins/plugins"})),Object(p["b"])({uiErrors:"uiplugins/errors"})),Object(p["b"])({theme:"prefs/theme"})),{},{applyDarkModeBg:function(){return"dark"===this.theme?{"dark-mode":!0}:{}},menuActions:function(){var e=[];return e.push({action:"manageRepos",label:this.t("plugins.manageRepos"),enabled:!0}),this.pluginDeveloper&&(e.push({divider:!0}),e.push({action:"devLoad",label:this.t("plugins.developer.label"),enabled:!0})),this.hasService&&(e.push({divider:!0}),e.push({action:"removePluginSupport",label:this.t("plugins.setup.remove.label"),enabled:!0})),e},list:function(){var e=this.available;switch(this.view){case"installed":return e.filter((function(e){return!!e.installed||!!e.installing}));case"updates":return this.updates;case"available":return e.filter((function(e){return!e.installed}));default:return e}},hasMenuActions:function(){var e;return(null===(e=this.menuActions)||void 0===e?void 0:e.length)>0},emptyMessage:function(){return this.t("plugins.empty.".concat(this.view))},updates:function(){return this.available.filter((function(e){return!!e.upgrade}))},available:function(){var e=this,t=this.charts.filter((function(e){return Object(j["m"])(e)}));return t=t.filter((function(e){return!Object(j["p"])(e,b["e"].HIDDEN,"true")})),t=t.map((function(t){var n,a,i=Object(j["o"])(j["f"].DISPLAY_NAME)||t.chartNameDisplay,s={name:t.chartNameDisplay,label:i,description:t.chartDescription,id:t.id,versions:[],installed:!1,builtin:!1,experimental:Object(j["p"])(t,b["e"].EXPERIMENTAL,"true"),certified:Object(j["p"])(t,b["e"].CERTIFIED,b["e"]._RANCHER)};s.versions=Object(r["a"])(t.versions),s.chart=t,s.installableVersions=s.versions.filter((function(t){return Object(j["l"])(t)&&Object(j["j"])(t,e.rancherVersion)})),s.versions=s.versions.map((function(t){return Object(j["j"])(t,e.rancherVersion,!0)}));var l,o,c=null===(n=s.installableVersions)||void 0===n?void 0:n[0],u=s.versions.find((function(e){return!e.isCompatibleWithUi}));c?(s.displayVersion=c.version,s.icon=c.icon):(s.displayVersion=null===(l=s.versions)||void 0===l||null===(o=l[0])||void 0===o?void 0:o.version,s.icon=t.icon||c.annotations["catalog.cattle.io/ui-icon"]);return u&&s.installableVersions.length&&Object(j["k"])(u.version,null===(a=s.installableVersions)||void 0===a?void 0:a[0].version)&&(s.incompatibleDisclaimer=e.t("plugins.incompatibleDisclaimer",{version:u.version,rancherVersion:u.requiredUiVersion},!0)),e.installing[s.name]&&(s.installing=e.installing[s.name]),s})),t=t.filter((function(e){return e.versions.length>0})),this.uiplugins.forEach((function(e){var n=t.find((function(t){return t.name===e.name}));if(!n){var a,i,r,l,o="object"===Object(s["a"])(null===(a=e.metadata)||void 0===a?void 0:a.rancher)?e.metadata.rancher:{},c=o[j["f"].DISPLAY_NAME]||e.name,u={name:e.name,label:c,description:null===(i=e.metadata)||void 0===i?void 0:i.description,icon:null===(r=e.metadata)||void 0===r?void 0:r.icon,id:e.id,versions:[],displayVersion:(null===(l=e.metadata)||void 0===l?void 0:l.version)||"-",installed:!0,builtin:!!e.builtin};t.push(u)}})),this.plugins.forEach((function(n){var a=t.find((function(e){return e.name===n.name}));if(a){var i,s,r;a.installed=!0,a.uiplugin=n,a.displayVersion=n.version,a.installing=e.installing[a.name],null!==(i=a.installableVersions)&&void 0!==i&&i.length&&n.version!==(null===(s=a.installableVersions)||void 0===s||null===(r=s[0])||void 0===r?void 0:r.version)&&(a.upgrade=a.installableVersions[0].version)}else{var l={name:n.name,label:n.name,description:n.description||"-",id:"".concat(n.name,"-").concat(n.version),versions:[],displayVersion:n.version||"-",installed:!0,installing:!1,builtin:!1,uiplugin:n};t.push(l)}})),Object.keys(this.uiErrors).forEach((function(n){var a=t.find((function(e){return e.name===n}));if(a){var i=e.uiErrors[n];a.error=!(!i||"string"!==typeof i)&&e.t(e.uiErrors[n])}})),Object.keys(this.errors).forEach((function(n){var a=t.find((function(e){return e.name===n}));a&&(a.helmError=!!e.errors[n])})),t.forEach((function(e){e.description&&e.description.length>N&&(e.description="".concat(e.description.substr(0,N)," ..."))})),Object(g["b"])(t,"name",!1)}}),watch:{helmOps:function(e){var t=this,n=e.filter((function(e){return e.namespace===j["g"]}));n=Object(g["b"])(n,"metadata.creationTimestamp",!0),(this.available||[]).forEach((function(e){var a=n.find((function(t){var n;return(null===(n=t.status)||void 0===n?void 0:n.releaseName)===e.name}));if(a){var i,s,r=null===(i=a.metadata.state)||void 0===i?void 0:i.transitioning,l=null===(s=a.metadata.state)||void 0===s?void 0:s.error;if(d["default"].set(t.errors,e.name,l),r){var o="upgrade"===a.status.action?"install":a.status.action;t.updatePluginInstallStatus(e.name,o)}else("uninstall"===a.status.action||l)&&t.updatePluginInstallStatus(e.name,!1)}else t.updatePluginInstallStatus(e.name,!1)}))},plugins:function(e,t){var n=this,a=this.$store.getters["uiplugins/plugins"],i=(a||[]).filter((function(e){return!n.uiErrors[e.name]&&!e.builtin})),s=0;(null===e||void 0===e?void 0:e.length)<i.length&&s++,e.forEach((function(e){var t=a.find((function(t){return!t.removed&&t.name===e.name&&t.version===e.version}));!t&&e.isCached&&(n.uiErrors[e.name]||s++,n.updatePluginInstallStatus(e.name,!1))})),s>0&&d["default"].set(this,"reloadRequired",!0)}},beforeDestroy:function(){this.$store.dispatch("management/forgetType",m["W"]),this.$store.dispatch("management/forgetType",m["f"].OPERATION),this.$store.dispatch("management/forgetType",m["f"].APP),this.$store.dispatch("management/forgetType",m["f"].CLUSTER_REPO)},methods:{updateInstallStatus:function(){var e=this;return Object(o["a"])(u.a.mark((function t(){var n,a;return u.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$store.dispatch("management/find",{type:m["Q"],id:"".concat(j["g"],"/ui-plugin-operator"),opt:{force:!0}});case 3:a=t.sent,n=!!a,t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),n=!1;case 10:return d["default"].set(e,"hasService",n),t.abrupt("return",n);case 12:case"end":return t.stop()}}),t,null,[[0,7]])})))()},filterChanged:function(e){this.view=e.selectedName},removePluginSupport:function(){this.$refs.removeUIPlugins.showDialog()},showDeveloperLoaddDialog:function(){this.$refs.developerInstallDialog.showDialog()},showInstallDialog:function(e,t,n){var a;null===(a=n.target)||void 0===a||a.blur(),n.preventDefault(),n.stopPropagation(),this.$refs.installDialog.showDialog(e,t)},showUninstallDialog:function(e,t){var n;null===(n=t.target)||void 0===n||n.blur(),t.preventDefault(),t.stopPropagation(),this.$refs.uninstallDialog.showDialog(e)},didUninstall:function(e){e&&(this.updatePluginInstallStatus(e.name,"uninstall"),this.$store.dispatch("uiplugins/setError",{name:e.name,error:!1}))},didInstall:function(e){var t;e&&(null===(t=this.$refs.tabs)||void 0===t||t.select("installed"),this.$store.dispatch("uiplugins/setError",{name:e.name,error:!1}))},showPluginDetail:function(e){this.$refs.infoPanel.show(e)},updatePluginInstallStatus:function(e,t){d["default"].set(this.installing,e,t)},setMenu:function(e){this.menuOpen=!!e,e?(this.menuTargetElement=this.$refs.actions,this.menuTargetEvent=e):(this.menuTargetElement=void 0,this.menuTargetEvent=void 0)},reload:function(){this.$router.go()},manageRepos:function(){this.$router.push({name:"c-cluster-product-resource",params:{cluster:"local",product:_["NAME"],resource:m["f"].CLUSTER_REPO}})}}},V=T,A=(n("9a1f"),n("0c7c")),U=Object(A["a"])(V,a,i,!1,null,"231e2bca",null);t["default"]=U.exports},"10ef":function(e,t,n){},1228:function(e,t,n){},"24c6":function(e,t,n){},"28f0":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("modal",{attrs:{name:"installPluginDialog",height:"auto",scrollable:!0}},[e.plugin?n("div",{staticClass:"plugin-install-dialog"},[n("h4",{staticClass:"mt-10"},[e._v(" "+e._s(e.t("plugins."+e.mode+".title",{name:e.plugin.label}))+" ")]),n("div",{staticClass:"custom mt-10"},[n("div",{staticClass:"dialog-panel"},[n("p",[e._v(" "+e._s(e.t("plugins."+e.mode+".prompt"))+" ")]),e.plugin.certified?e._e():n("Banner",{attrs:{color:"warning",label:e.t("plugins.install.warnNotCertified")}}),e.showVersionSelector?n("LabeledSelect",{staticClass:"version-selector mt-10",attrs:{"label-key":"plugins.install.version",options:e.versionOptions,"data-testid":"install-ext-modal-select-version"},model:{value:e.version,callback:function(t){e.version=t},expression:"version"}}):n("div",[e._v(" "+e._s(e.t("plugins.install.version"))+" "+e._s(e.version)+" ")])],1),n("div",{staticClass:"dialog-buttons"},[n("button",{staticClass:"btn role-secondary",attrs:{disabled:e.busy,"data-testid":"install-ext-modal-cancel-btn"},on:{click:function(t){return e.closeDialog(!1)}}},[e._v(" "+e._s(e.t("generic.cancel"))+" ")]),n("AsyncButton",{attrs:{mode:e.buttonMode,"data-testid":"install-ext-modal-install-btn"},on:{click:e.install}})],1)])]):e._e()])},i=[],s=n("ade3"),r=n("1da1"),l=(n("cf99"),n("8be0"),n("bb4d"),n("9d9d"),n("0b7a"),n("a797"),n("5986"),n("b0b4"),n("2b77"),n("a34a")),o=n.n(l),c=(n("96cf"),n("67c9")),u=n("a95f"),d=n("a788"),p=n("7388"),v=n("7600"),g=n("01ba"),f={components:{AsyncButton:c["b"],Banner:g["a"],LabeledSelect:u["a"]},fetch:function(){var e=this;return Object(r["a"])(o.a.mark((function t(){return o.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("management/find",{type:d["x"].SETTING,id:"system-default-registry"});case 2:e.defaultRegistrySetting=t.sent;case 3:case"end":return t.stop()}}),t)})))()},data:function(){return{currentVersion:"",defaultRegistrySetting:null,plugin:void 0,busy:!1,version:"",update:!1,mode:""}},computed:{showVersionSelector:function(){var e;return(null===(e=this.versionOptions)||void 0===e?void 0:e.length)>1},versionOptions:function(){var e,t,n=this;if(!this.plugin)return[];var a=null===(e=this.plugin)||void 0===e||null===(t=e.installableVersions)||void 0===t?void 0:t.filter((function(e){return!n.currentVersion||e.version!==n.currentVersion}));return a.map((function(e){return{label:e.version,value:e.version}}))},buttonMode:function(){return this.update?"update":"install"}},methods:{showDialog:function(e,t){var n,a,i,s,r=this;if(this.plugin=e,this.mode=t,this.version=e.displayVersion,"update"===t)this.currentVersion=e.displayVersion,(null===(a=e.installableVersions)||void 0===a?void 0:a.length)>0&&(this.version=null===(i=e.installableVersions)||void 0===i||null===(s=i[0])||void 0===s?void 0:s.version);else if("rollback"===t){var l=e.installableVersions.filter((function(t){return t.version!==e.displayVersion}));this.currentVersion=e.displayVersion,l.length>0&&(this.version=l[0].version)}var o,c,u=null===(n=e.installableVersions)||void 0===n?void 0:n.find((function(e){return e.version===r.version}));u||(this.version=null===(o=e.installableVersions)||void 0===o||null===(c=o[0])||void 0===c?void 0:c.version);this.busy=!1,this.update="install"!==t,this.$modal.show("installPluginDialog")},closeDialog:function(e){this.$modal.hide("installPluginDialog"),this.$emit("closed",e)},install:function(){var e=this;return Object(r["a"])(o.a.mark((function t(){var n,a,i,r,l,c,u,g,f,m,h,b,_,y,C,x,w,O,k,I,P;return o.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.busy=!0,r=e.plugin,e.$emit("update",r.name,"install"),l=null===(n=r.versions)||void 0===n?void 0:n.find((function(t){return t.version===e.version})),l){t.next=7;break}return e.busy=!1,t.abrupt("return");case 7:return c=!1,t.prev=8,t.next=11,e.$store.dispatch("catalog/getVersionInfo",{repoType:l.repoType,repoName:l.repoName,chartName:r.chart.chartName,versionName:e.version});case 11:f=t.sent,m=(null===f||void 0===f||null===(u=f.values)||void 0===u||null===(g=u.image)||void 0===g?void 0:g.repository)||"",c=m.startsWith("rancher/"),t.next=18;break;case 16:t.prev=16,t.t0=t["catch"](8);case 18:return h=!1,t.prev=19,t.next=22,e.$store.dispatch("management/find",{type:d["f"].APP,id:"".concat(v["g"],"/").concat(r.chart.chartName),opt:{force:!0}});case 22:b=t.sent,h=!!b,t.next=28;break;case 26:t.prev=26,t.t1=t["catch"](19);case 28:return _=l.repoType,y=l.repoName,C=e.$store.getters["catalog/repo"]({repoType:_,repoName:y}),x={chartName:r.chart.chartName,version:e.version,releaseName:r.chart.chartName,annotations:(a={},Object(s["a"])(a,p["e"].SOURCE_REPO_TYPE,r.repoType),Object(s["a"])(a,p["e"].SOURCE_REPO_NAME,r.repoName),a),values:{}},w=(null===(i=e.defaultRegistrySetting)||void 0===i?void 0:i.value)||"",c&&w&&(x.values.global=x.values.global||{},x.values.global.cattle=x.values.global.cattle||{},x.values.global.cattle.systemDefaultRegistry=w),O={charts:[x],namespace:v["g"]},k=h||e.update?"upgrade":"install",t.prev=36,t.next=39,C.doAction(k,O);case 39:return I=t.sent,P="".concat(I.operationNamespace,"/").concat(I.operationName),e.closeDialog(r),t.next=44,C.waitForOperation(P);case 44:return t.next=46,e.$store.dispatch("management/find",{type:d["f"].OPERATION,id:P});case 46:t.next=52;break;case 48:t.prev=48,t.t2=t["catch"](36),e.$store.dispatch("growl/error",{title:e.t("plugins.error.generic"),message:t.t2.message?t.t2.message:t.t2,timeout:1e4},{root:!0}),e.closeDialog(r);case 52:case"end":return t.stop()}}),t,null,[[8,16],[19,26],[36,48]])})))()}}},m=f,h=(n("dd38"),n("0c7c")),b=Object(h["a"])(m,a,i,!1,null,"0c3745a3",null);t["default"]=b.exports},"3bb8":function(e,t,n){},"45ca":function(e,t,n){"use strict";n("10ef")},"4ac9":function(e,t,n){},"4e66":function(e,t,n){"use strict";n("4ac9")},"53a6":function(e,t,n){e.exports=n.p+"img/generic-plugin.3cca4b04.svg"},"7bbe":function(e,t,n){"use strict";n("8943")},8943:function(e,t,n){},"94af":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("modal",{attrs:{name:"uninstallPluginDialog",height:"auto",scrollable:!0}},[e.plugin?n("div",{staticClass:"plugin-install-dialog"},[n("h4",{staticClass:"mt-10"},[e._v(" "+e._s(e.t("plugins.uninstall.title",{name:e.plugin.label}))+" ")]),n("div",{staticClass:"mt-10 dialog-panel"},[n("div",{staticClass:"dialog-info"},[n("p",[e._v(" "+e._s(e.t("plugins.uninstall.prompt"))+" ")])]),n("div",{staticClass:"dialog-buttons"},[n("button",{staticClass:"btn role-secondary",attrs:{disabled:e.busy,"data-testid":"uninstall-ext-modal-cancel-btn"},on:{click:function(t){return e.closeDialog(!1)}}},[e._v(" "+e._s(e.t("generic.cancel"))+" ")]),n("AsyncButton",{attrs:{mode:"uninstall","data-testid":"uninstall-ext-modal-uninstall-btn"},on:{click:function(t){return e.uninstall()}}})],1)])]):e._e()])},i=[],s=n("1da1"),r=n("a34a"),l=n.n(r),o=(n("96cf"),n("0b7a"),n("9d9d"),n("8be0"),n("67c9")),c=n("a788"),u=n("7600"),d={components:{AsyncButton:o["b"]},data:function(){return{plugin:void 0,busy:!1}},methods:{showDialog:function(e){this.plugin=e,this.busy=!1,this.$modal.show("uninstallPluginDialog")},closeDialog:function(e){this.$modal.hide("uninstallPluginDialog"),this.$emit("closed",e)},uninstall:function(){var e=this;return Object(s["a"])(l.a.mark((function t(){var n,a,i,s;return l.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.busy=!0,a=e.plugin,e.$emit("update",a.name,"uninstall"),null===(n=a.uiplugin)||void 0===n||!n.isDeveloper){t.next=6;break}return t.next=6,a.uiplugin.remove();case 6:return t.next=8,e.$store.dispatch("management/findAll",{type:c["f"].APP});case 8:if(i=t.sent,s=i.find((function(e){return e.namespace===u["g"]&&e.name===a.name})),!s){t.next=21;break}return t.prev=11,t.next=14,s.remove();case 14:t.next=19;break;case 16:t.prev=16,t.t0=t["catch"](11),e.$store.dispatch("growl/error",{title:e.t("plugins.error.generic"),message:t.t0.message?t.t0.message:t.t0,timeout:1e4},{root:!0});case 19:return t.next=21,e.$store.dispatch("management/findAll",{type:c["f"].OPERATION});case 21:e.closeDialog(a);case 22:case"end":return t.stop()}}),t,null,[[11,16]])})))()}}},p=d,v=(n("7bbe"),n("0c7c")),g=Object(v["a"])(p,a,i,!1,null,"3afa020e",null);t["default"]=g.exports},9744:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("modal",{attrs:{name:"developerInstallPluginDialog",height:"auto",scrollable:!0}},[n("div",{staticClass:"plugin-install-dialog"},[n("h4",[e._v(" "+e._s(e.t("plugins.developer.title"))+" ")]),n("p",[e._v(" "+e._s(e.t("plugins.developer.prompt"))+" ")]),n("div",{staticClass:"custom mt-10"},[n("div",{staticClass:"fields"},[n("LabeledInput",{directives:[{name:"focus",rawName:"v-focus"}],attrs:{"label-key":"plugins.developer.fields.url"},on:{input:e.updateLocation},model:{value:e.location,callback:function(t){e.location=t},expression:"location"}})],1)]),n("div",{staticClass:"custom mt-10"},[n("div",{staticClass:"fields"},[n("LabeledInput",{attrs:{"label-key":"plugins.developer.fields.name"},on:{input:e.updateName},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}})],1),n("div",{staticClass:"fields mt-10"},[n("Checkbox",{attrs:{"label-key":"plugins.developer.fields.persist"},model:{value:e.persist,callback:function(t){e.persist=t},expression:"persist"}})],1),n("div",{staticClass:"dialog-buttons mt-20"},[n("button",{staticClass:"btn role-secondary",attrs:{"data-testid":"dev-install-ext-modal-cancel-btn"},on:{click:function(t){return e.closeDialog()}}},[e._v(" "+e._s(e.t("generic.cancel"))+" ")]),n("AsyncButton",{attrs:{mode:"load","data-testid":"dev-install-ext-modal-install-btn"},on:{click:e.loadPlugin}})],1)])])])},i=[],s=n("53ca"),r=n("1da1"),l=n("a34a"),o=n.n(l),c=(n("96cf"),n("2b77"),n("0b7a"),n("181c"),n("67c9")),u=n("84d3"),d=n("bd30"),p=n("a788"),v=n("7600"),g={components:{AsyncButton:c["b"],Checkbox:d["a"],LabeledInput:u["a"]},data:function(){return{name:"",location:"",persist:!1,canModifyName:!0,canModifyLocation:!0}},watch:{name:function(e,t){this.canModifyLocation&&(this.location="/pkg/".concat(e,"/").concat(e,".umd.min.js"))},location:function(e,t){if(this.canModifyName){var n=e.split("/"),a=n[n.length-1],i=a.indexOf(".umd.min.js");-1!==i?a=a.substr(0,i):(i=a.indexOf(".umd.js"),-1!==i&&(a=a.substr(0,i))),this.name=a}}},methods:{showDialog:function(){this.$modal.show("developerInstallPluginDialog")},closeDialog:function(e){this.$modal.hide("developerInstallPluginDialog"),this.$emit("closed",e)},updateName:function(e){this.canModifyName=0===e.length},updateLocation:function(e){this.canModifyLocation=0===e.length},loadPlugin:function(e){var t=this;return Object(r["a"])(o.a.mark((function n(){var a,i,r,l,c,u,d,g;return o.a.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(a=t.name,i=t.location,a||(r=i.split("/"),l=r[r.length-1],a=l.split(".")[0]),c="0.0.1",u=a,d=a.split("-"),d.length>=2&&(c=d.pop(),u=d.join("-")),!t.persist){n.next=20;break}return n.next=10,t.$store.dispatch("management/create",{type:p["W"],metadata:{name:a,namespace:v["g"]},spec:{plugin:{name:u,version:c,endpoint:i,noCache:!0,metadata:{developer:"true",direct:"true"}}}});case 10:return g=n.sent,n.prev=11,n.next=14,g.save({url:"/v1/".concat(p["W"]),method:"POST"});case 14:n.next=20;break;case 16:n.prev=16,n.t0=n["catch"](11),console.error("Could not create CRD for plugin",n.t0),e(!1);case 20:t.$plugin.loadAsync(a,i).then((function(){t.closeDialog(!0),t.$store.dispatch("growl/success",{title:t.t("plugins.success.title",{name:a}),message:t.t("plugins.success.message"),timeout:3e3},{root:!0}),e(!0)})).catch((function(n){e(!1);var a="object"===Object(s["a"])(n)?t.t("plugins.error.message"):n;t.$store.dispatch("growl/error",{title:t.t("plugins.error.title"),message:a,timeout:5e3},{root:!0})}));case 21:case"end":return n.stop()}}),n,null,[[11,16]])})))()}}},f=g,m=(n("b07c"),n("0c7c")),h=Object(m["a"])(f,a,i,!1,null,"c8f2eee2",null);t["default"]=h.exports},"9a1f":function(e,t,n){"use strict";n("d383")},b07c:function(e,t,n){"use strict";n("cc98")},b4b2:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"plugin-info-panel",style:"--banner-top-offset: "+e.headerBannerSize+"px"},[e.showSlideIn?n("div",{staticClass:"glass",attrs:{"data-testid":"extension-details-bg"},on:{click:function(t){return e.hide()}}}):e._e(),n("div",{staticClass:"slideIn",class:{hide:!1,slideIn__show:e.showSlideIn},attrs:{"data-testid":"extension-details"}},[e.info?n("div",{staticClass:"plugin-info-content"},[n("div",{staticClass:"plugin-header"},[n("div",{staticClass:"plugin-icon",class:e.applyDarkModeBg},[e.info.icon?n("LazyImage",{staticClass:"icon plugin-icon-img",attrs:{"initial-src":e.defaultIcon,"error-src":e.defaultIcon,src:e.info.icon}}):n("img",{staticClass:"icon plugin-icon-img",attrs:{src:e.defaultIcon}})],1),n("div",{staticClass:"plugin-title"},[n("h2",{staticClass:"slideIn__header",attrs:{"data-testid":"extension-details-title"}},[e._v(" "+e._s(e.info.label)+" ")]),n("p",{staticClass:"plugin-description"},[e._v(" "+e._s(e.info.description)+" ")])]),n("div",{staticClass:"plugin-close"},[n("div",{staticClass:"slideIn__header__buttons"},[n("div",{staticClass:"slideIn__header__button",attrs:{"data-testid":"extension-details-close"},on:{click:function(t){e.showSlideIn=!1}}},[n("i",{staticClass:"icon icon-close"})])])])]),n("div",[e.info.error?n("Banner",{staticClass:"mt-10",attrs:{color:"error",label:e.info.error}}):e._e(),e.info.builtin?n("Banner",{staticClass:"mt-10",attrs:{color:"warning",label:e.t("plugins.descriptions.built-in")}}):[e.info.certified?e._e():n("Banner",{staticClass:"mt-10",attrs:{color:"warning",label:e.t("plugins.descriptions.third-party")}}),e.info.experimental?n("Banner",{staticClass:"mt-10",attrs:{color:"warning",label:e.t("plugins.descriptions.experimental")}}):e._e()]],2),e.info.versions.length?n("h3",[e._v(" "+e._s(e.t("plugins.info.versions"))+" ")]):e._e(),n("div",{staticClass:"plugin-versions mb-10"},e._l(e.info.versions,(function(t){return n("div",{key:t.version},[n("a",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.requiredUiVersion?e.t("plugins.info.requiresVersion",{version:t.requiredUiVersion}):"",expression:"v.requiredUiVersion ? t('plugins.info.requiresVersion', { version: v.requiredUiVersion }) : ''"}],staticClass:"version-link",class:{"version-active":t.version===e.infoVersion,disabled:!t.isCompatibleWithUi},on:{click:function(n){return e.loadPluginVersionInfo(t.version)}}},[e._v(" "+e._s(t.version)+" ")])])})),0),e.versionError?n("div",[e._v(" "+e._s(e.t("plugins.info.versionError"))+" ")]):e._e(),e.versionInfo?n("h3",[e._v(" "+e._s(e.t("plugins.info.detail"))+" ")]):e._e(),e.versionInfo?n("div",{staticClass:"plugin-info-detail"},[e.versionInfo?n("ChartReadme",{attrs:{"version-info":e.versionInfo}}):e._e()],1):e._e(),e.info.versions.length?e._e():n("div",[n("h3",[e._v(" "+e._s(e.t("plugins.info.versions"))+" ")]),n("div",{staticClass:"version-link version-active version-builtin"},[e._v(" "+e._s(e.info.displayVersion)+" ")])])]):e._e()])])},i=[],s=(n("1d8f"),n("13ec"),n("cf99"),n("7e5b"),n("38aa"),n("bcff"),n("ade3")),r=n("1da1"),l=n("a34a"),o=n.n(l),c=(n("96cf"),n("ed26"),n("9d9d"),n("8be0"),n("2f62")),u=n("5fc0"),d=n("bec1"),p=n("bc1c"),v=n("a788"),g=n("c5b9");function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){Object(s["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var h={fetch:function(){var e=this;return Object(r["a"])(o.a.mark((function t(){var n,a,i,s,r,l,c;return o.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$store.getters["management/byId"](v["x"].SETTING,g["c"].BANNERS);case 2:n=t.sent,a=JSON.parse(n.value),i=a.showHeader,s=a.bannerHeader,"true"===i&&(c=Number(null!==(r=null===s||void 0===s||null===(l=s.fontSize)||void 0===l?void 0:l.split("px")[0])&&void 0!==r?r:0),e.headerBannerSize=2*c);case 5:case"end":return t.stop()}}),t)})))()},components:{Banner:d["a"],ChartReadme:u["a"],LazyImage:p["a"]},data:function(){return{showSlideIn:!1,info:void 0,infoVersion:void 0,versionInfo:void 0,versionError:void 0,defaultIcon:n("53a6"),headerBannerSize:0}},computed:m(m({},Object(c["b"])({theme:"prefs/theme"})),{},{applyDarkModeBg:function(){return"dark"===this.theme?{"dark-mode":!0}:{}}}),methods:{show:function(e){this.info=e,this.showSlideIn=!0,this.version=null,this.versionInfo=null,this.versionError=null,this.loadPluginVersionInfo()},hide:function(){this.showSlideIn=!1},loadPluginVersionInfo:function(e){var t=this;return Object(r["a"])(o.a.mark((function n(){var a,i,s;return o.a.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(i=e||t.info.displayVersion,s=null===(a=t.info.versions)||void 0===a?void 0:a.find((function(e){return e.version===i&&!e.isCompatibleWithUi})),t.info.chart&&!s){n.next=4;break}return n.abrupt("return");case 4:return t.infoVersion=i,t.versionError=!1,t.versionInfo=void 0,n.prev=7,n.next=10,t.$store.dispatch("catalog/getVersionInfo",{repoType:t.info.chart.repoType,repoName:t.info.chart.repoName,chartName:t.info.chart.chartName,versionName:i});case 10:t.versionInfo=n.sent,n.next=17;break;case 13:n.prev=13,n.t0=n["catch"](7),t.versionError=!0,console.error("Unable to fetch VersionInfo: ",n.t0);case 17:case"end":return n.stop()}}),n,null,[[7,13]])})))()}}},b=h,_=(n("4e66"),n("0c7c")),y=Object(_["a"])(b,a,i,!1,null,"226184da",null);t["default"]=y.exports},c150:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("IconMessage",{attrs:{vertical:!0,subtle:!1,icon:"icon-gear"},scopedSlots:e._u([{key:"message",fn:function(){return[n("h2",[e._v(" "+e._s(e.t("plugins.setup.title"))+" ")]),e.loading?e._e():n("div",[e.haveCharts?n("div",[n("p",[e._v(" "+e._s(e.t("plugins.setup.prompt.can"))+" ")]),n("AsyncButton",{staticClass:"enable-plugin-support",attrs:{mode:"enable",manual:!0,"current-phase":e.buttonState,"data-testid":"extension-enable-operator"},on:{click:e.enable}})],1):n("div",[n("p",[e._v(" "+e._s(e.t("plugins.setup.prompt.cant"))+" ")])]),e._l(e.errors,(function(t,a){return n("div",{key:a,staticClass:"plugin-setup-error"},[e._v(" "+e._s(t)+" ")])}))],2)]},proxy:!0}])}),n("Dialog",{attrs:{name:"confirm-uiplugins-setup",title:e.t("plugins.setup.install.title")},on:{closed:e.dialogClosed}},[[n("p",[e._v(" "+e._s(e.t("plugins.setup.install.prompt"))+" ")]),e.hasRancherUIPluginsRepo?e._e():n("div",{staticClass:"mt-20"},[n("Checkbox",{attrs:{primary:!0,"label-key":"plugins.setup.install.addRancherRepo"},model:{value:e.addRepo,callback:function(t){e.addRepo=t},expression:"addRepo"}}),n("div",{staticClass:"checkbox-info"},[e._v(" "+e._s(e.t("plugins.setup.install.airgap"))+" ")])],1)]],2)],1)},i=[],s=n("ade3"),r=n("1da1"),l=n("a34a"),o=n.n(l),c=(n("96cf"),n("4d7f"),n("8be0"),n("38aa"),n("9d9d"),n("0b7a"),n("a797"),n("5986"),n("2b77"),n("e673"),n("67c9")),u=n("2678"),d=n("a788"),p=n("7388"),v=n("e5e4"),g=n("bd30"),f=n("7600"),m={components:{AsyncButton:c["b"],Checkbox:g["a"],IconMessage:u["a"],Dialog:v["a"]},fetch:function(){var e=this;return Object(r["a"])(o.a.mark((function t(){var n,a,i;return o.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=e.$store.getters["catalog/rawCharts"],a=Object.values(n),i=[],f["e"].forEach((function(e){var t=a.find((function(t){return t.repoName===f["i"]&t.chartName===e}));t&&i.push(t)})),e.haveCharts=i.length===f["e"].length,!e.haveCharts){t.next=10;break}if(e.installCharts=i,!e.$store.getters["management/schemaFor"](d["f"].CLUSTER_REPO)){t.next=10;break}return t.next=10,e.$store.dispatch("management/findAll",{type:d["f"].CLUSTER_REPO});case 10:return t.next=12,e.$store.dispatch("management/find",{type:d["x"].SETTING,id:"system-default-registry"});case 12:e.defaultRegistrySetting=t.sent,e.loading=!1;case 14:case"end":return t.stop()}}),t)})))()},data:function(){return{loading:!0,haveCharts:!1,installCharts:[],errors:[],addRepo:!0,buttonState:c["a"].ACTION,defaultRegistrySetting:null}},computed:{hasRancherUIPluginsRepo:function(){var e=this.$store.getters["catalog/repos"];return!!e.find((function(e){return e.name===f["b"]}))}},methods:{installChart:function(e){var t=this;return Object(r["a"])(o.a.mark((function n(){var a,i,r,l,c,u,v,g,m,h,b,_;return o.a.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=e.versions[0],l=r.repoType,c=r.repoName,u=t.$store.getters["catalog/repo"]({repoType:l,repoName:c}),v={chartName:e.chartName,version:r.version,releaseName:e.chartName,annotations:(a={},Object(s["a"])(a,p["e"].SOURCE_REPO_TYPE,l),Object(s["a"])(a,p["e"].SOURCE_REPO_NAME,c),a),values:{}},g=(null===(i=t.defaultRegistrySetting)||void 0===i?void 0:i.value)||"",g&&(v.values.global=v.values.global||{},v.values.global.cattle=v.values.global.cattle||{},v.values.global.cattle.systemDefaultRegistry=g),m={charts:[v],wait:!0,namespace:f["g"]},h="install",n.next=11,u.doAction(h,m);case 11:return b=n.sent,_="".concat(b.operationNamespace,"/").concat(b.operationName),n.next=15,u.waitForOperation(_);case 15:return n.abrupt("return",t.$store.dispatch("management/find",{type:d["f"].OPERATION,id:_}));case 16:case"end":return n.stop()}}),n)})))()},enable:function(){this.errors=[],this.addRepo=!this.hasRancherUIPluginsRepo,this.$modal.show("confirm-uiplugins-setup")},dialogClosed:function(e){var t=this;return Object(r["a"])(o.a.mark((function n(){return o.a.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t.errors=[],!e){n.next=12;break}if(t.buttonState=c["a"].WAITING,!t.addRepo){n.next=6;break}return n.next=6,t.addDefaultHelmRepository();case 6:return n.next=8,t.installPluginCharts();case 8:return n.next=10,new Promise((function(e){return setTimeout(e,5e3)}));case 10:t.buttonState=t.errors.length>0?c["a"].ERROR:c["a"].ACTION,t.$emit("done");case 12:case"end":return n.stop()}}),n)})))()},addDefaultHelmRepository:function(){var e=this;return Object(r["a"])(o.a.mark((function t(){var n,a;return o.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=f["b"],t.prev=1,t.next=4,e.$store.dispatch("management/create",{type:d["f"].CLUSTER_REPO,metadata:{name:n},spec:{gitBranch:f["a"],gitRepo:f["c"]}});case 4:return a=t.sent,t.abrupt("return",a.save());case 8:t.prev=8,t.t0=t["catch"](1),console.error(t.t0),e.errors.push(t.t0.message);case 12:case"end":return t.stop()}}),t,null,[[1,8]])})))()},installPluginCharts:function(){var e=this;return Object(r["a"])(o.a.mark((function t(){var n,a;return o.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:n=0;case 1:if(!(n<e.installCharts.length)){t.next=14;break}return a=e.installCharts[n],t.prev=3,t.next=6,e.installChart(a);case 6:t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](3),e.errors.push(t.t0.message);case 11:n++,t.next=1;break;case 14:return t.abrupt("return",new Promise((function(e){return setTimeout(e,2e3)})));case 15:case"end":return t.stop()}}),t,null,[[3,8]])})))()}}},h=m,b=(n("f413"),n("0c7c")),_=Object(b["a"])(h,a,i,!1,null,"320baac8",null);t["default"]=_.exports},cc98:function(e,t,n){},d383:function(e,t,n){},d3f4:function(e,t,n){"use strict";n("1228")},dd38:function(e,t,n){"use strict";n("3bb8")},e5e4:function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("modal",{attrs:{name:e.name,height:"auto",scrollable:!0},on:{closed:function(t){return e.closeDialog(!1)},"before-open":e.beforeOpen}},[n("div",{staticClass:"modal-dialog"},[n("h4",[e._v(" "+e._s(e.title)+" ")]),e._t("default"),n("div",{staticClass:"dialog-buttons mt-20"},[e._t("buttons"),e.$slots.buttons?e._e():n("div",[n("button",{staticClass:"btn role-secondary",on:{click:function(t){return e.closeDialog(!1)}}},[e._v(" "+e._s(e.t("generic.cancel"))+" ")]),e.mode?n("AsyncButton",{staticClass:"ml-10",attrs:{mode:e.mode},on:{click:e.ok}}):n("button",{staticClass:"btn role-primary ml-10",on:{click:function(t){return e.closeDialog(!0)}}},[e._v(" "+e._s(e.t("generic.ok"))+" ")])],1)],2)],2)])},i=[],s=(n("0b7a"),n("67c9")),r={components:{AsyncButton:s["b"]},props:{name:{type:String,required:!0},title:{type:String,required:!0},mode:{type:String,default:""}},data:function(){return{closed:!1}},methods:{beforeOpen:function(){this.closed=!1},ok:function(e){var t=this,n=function(n){e(n),n&&t.closeDialog(!0)};this.$emit("okay",n)},closeDialog:function(e){this.closed||(this.$modal.hide(this.name),this.$emit("closed",e),this.closed=!0)}}},l=r,o=(n("45ca"),n("0c7c")),c=Object(o["a"])(l,a,i,!1,null,"5130a572",null);t["a"]=c.exports},f413:function(e,t,n){"use strict";n("24c6")}}]);
//# sourceMappingURL=index.3d27101d.js.map