(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages/account/index"],{"0096":function(t,e,n){},"1f12":function(t,e,n){},"67f6":function(t,e,n){},8309:function(t,e,n){"use strict";n("1d8f"),n("0b7a");e["a"]={data:function(){return{backLink:null}},beforeRouteEnter:function(t,e,n){n((function(t){(Object.keys(e.params).length||"home"===e.name)&&(t.backLink=e)}))}}},"95bf":function(t,e,n){"use strict";n("0096")},a07c:function(t,e,n){"use strict";n("1f12")},bad9:function(t,e,n){"use strict";n("67f6")},f7d8:function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.link&&t.link.name?n("nuxt-link",{staticClass:"back-link",attrs:{to:t.link}},[n("i",{staticClass:"icon icon-chevron-left"}),t._v(" "+t._s(t.t("generic.back"))+" ")]):t._e()},r=[],s={props:{link:{type:Object,default:null}}},c=s,i=(n("95bf"),n("0c7c")),o=Object(i["a"])(c,a,r,!1,null,"da96e612",null);e["a"]=o.exports},f89b:function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.$fetchState.pending?n("Loading"):n("div",[n("BackLink",{attrs:{link:t.backLink}}),n("h1",{directives:[{name:"t",rawName:"v-t",value:"accountAndKeys.title",expression:"'accountAndKeys.title'"}]}),n("h2",{directives:[{name:"t",rawName:"v-t",value:"accountAndKeys.account.title",expression:"'accountAndKeys.account.title'"}]}),n("div",{staticClass:"account"},[n("Principal",{key:t.principal.id,attrs:{value:t.principal.id,"use-muted":!1,"show-labels":!0}}),n("div",[t.canChangePassword?n("button",{staticClass:"btn role-primary",attrs:{type:"button"},on:{click:function(e){return t.$refs.promptChangePassword.show(!0)}}},[t._v(" "+t._s(t.t("accountAndKeys.account.change"))+" ")]):t._e()])],1),n("PromptChangePassword",{ref:"promptChangePassword"}),n("hr"),n("div",{staticClass:"keys-header"},[n("div",[n("h2",{directives:[{name:"t",rawName:"v-t",value:"accountAndKeys.apiKeys.title",expression:"'accountAndKeys.apiKeys.title'"}]}),n("div",{staticClass:"api-url"},[n("span",[t._v(t._s(t.t("accountAndKeys.apiKeys.apiEndpoint")))]),n("CopyToClipboardText",{attrs:{text:t.apiUrl}})],1)]),t.apiKeySchema?n("button",{staticClass:"btn role-primary add mb-20",on:{click:t.addKey}},[t._v(" "+t._s(t.t("accountAndKeys.apiKeys.add.label"))+" ")]):t._e()]),t.apiKeySchema?n("div",{staticClass:"keys"},[n("ResourceTable",{attrs:{schema:t.apiKeySchema,rows:t.apiKeys,headers:t.apiKeyheaders,"key-field":"id",search:!0,"row-actions":!0,"table-actions":!0}})],1):n("div",[n("Banner",{attrs:{color:"warning",label:t.t("accountAndKeys.apiKeys.notAllowed")}})],1)],1)},r=[],s=(n("1d8f"),n("13ec"),n("7e5b"),n("38aa"),n("bcff"),n("ade3")),c=n("1da1"),i=n("a34a"),o=n.n(i),u=(n("96cf"),n("9d9d"),n("8be0"),n("2b77"),n("b667"),n("ddc0"),n("cf99"),n("f7d8")),l=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("modal",{staticClass:"change-password-modal",attrs:{name:"password-modal",width:500,height:465}},[n("Card",{staticClass:"prompt-password",attrs:{"show-highlight-border":!1},scopedSlots:t._u([{key:"actions",fn:function(){return[n("button",{staticClass:"btn role-secondary",attrs:{type:"reset"},on:{click:function(e){return t.show(!1)}}},[t._v(" "+t._s(t.t("changePassword.cancel"))+" ")]),n("AsyncButton",{staticClass:"btn bg-error ml-10",attrs:{type:"submit",mode:"apply",disabled:!t.valid,value:"LOGIN"},on:{click:t.submit}})]},proxy:!0}])},[n("h4",{staticClass:"text-default-text",attrs:{slot:"title"},slot:"title"},[t._v(" "+t._s(t.t("changePassword.title"))+" ")]),n("div",{attrs:{slot:"body"},slot:"body"},[n("form",{on:{submit:function(t){t.preventDefault()}}},[n("ChangePassword",{ref:"changePassword",on:{valid:function(e){t.valid=e}}})],1)])])],1)},p=[],d=n("2f62"),f=n("60ba"),h=n("d4bf"),b=n("67c9");function y(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function v(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?y(Object(n),!0).forEach((function(e){Object(s["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var w={components:{Card:h["a"],AsyncButton:b["b"],ChangePassword:f["a"]},data:function(){return{valid:!1,password:""}},computed:v({},Object(d["b"])({t:"i18n/t"})),methods:{show:function(t){t?this.$modal.show("password-modal"):this.$modal.hide("password-modal")},submit:function(t){var e=this;return Object(c["a"])(o.a.mark((function n(){return o.a.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,e.$refs.changePassword.save();case 3:e.show(!1),t(!0),n.next=10;break;case 7:n.prev=7,n.t0=n["catch"](0),t(!1);case 10:case"end":return n.stop()}}),n,null,[[0,7]])})))()}}},m=w,g=(n("bad9"),n("0c7c")),O=Object(g["a"])(m,l,p,!1,null,"4d41c8b5",null),k=O.exports,P=n("a788"),j=n("c5b9"),C=n("c778"),x=n("5a00"),K=n("8309"),_=n("bec1"),S=n("b178"),A=n("4703");function $(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function E(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?$(Object(n),!0).forEach((function(e){Object(s["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):$(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var D="/v3",T={layout:"plain",components:{CopyToClipboardText:A["a"],BackLink:u["a"],Banner:_["a"],PromptChangePassword:k,Loading:C["a"],ResourceTable:S["a"],Principal:x["a"]},mixins:[K["a"]],fetch:function(){var t=this;return Object(c["a"])(o.a.mark((function e(){var n,a,r;return o.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.calcCanChangePassword();case 2:if(t.canChangePassword=e.sent,!t.apiKeySchema){e.next=7;break}return e.next=6,t.$store.dispatch("rancher/findAll",{type:P["D"].TOKEN});case 6:t.rows=e.sent;case 7:return e.next=9,t.$store.dispatch("management/findAll",{type:P["x"].SETTING});case 9:n=e.sent,a=n.find((function(t){return t.id===j["c"].API_HOST})),r=n.find((function(t){return t.id===j["c"].SERVER_URL})),t.apiHostSetting=null===a||void 0===a?void 0:a.value,t.serverUrlSetting=null===r||void 0===r?void 0:r.value;case 14:case"end":return e.stop()}}),e)})))()},data:function(){return{apiHostSetting:null,serverUrlSetting:null,rows:null,canChangePassword:!1}},computed:E(E({},Object(d["b"])({t:"i18n/t"})),{},{apiKeyheaders:function(){return this.apiKeySchema?this.$store.getters["type-map/headersFor"](this.apiKeySchema):[]},apiUrlBase:function(){var t=this.apiHostSetting;t&&0!==t.indexOf("http")&&(t="http://".concat(t));var e=t||this.serverUrlSetting;return 0!==e.indexOf("http")&&(e="".concat(window.location.origin,"/").concat(e.replace(/^\/+/,""))),e="".concat(e.replace(/\/+$/,""),"/"),e},apiUrl:function(){var t=this.apiUrlBase,e=D.replace(/^\/+/,"");return"".concat(t).concat(e)},apiKeySchema:function(){try{return this.$store.getters["rancher/schemaFor"](P["D"].TOKEN)}catch(t){}return null},principal:function(){var t=this.$store.getters["auth/principalId"],e=this.$store.getters["rancher/byId"](P["D"].PRINCIPAL,t);return e||console.error("Failed to find principal with id: ",t),e||{}},apiKeys:function(){var t=function(t){var e=t.labels,n=t.expired,a=t.current;return(!n||!e||!e["ui-session"])&&!a};return this.rows?this.rows.filter(t):[]}}),methods:{addKey:function(){this.$router.push({path:"account/create-key"})},calcCanChangePassword:function(){var t=this;return Object(c["a"])(o.a.mark((function e(){var n;return o.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.$store.getters["auth/enabled"]){e.next=2;break}return e.abrupt("return",!1);case 2:if("local"!==t.principal.provider){e.next=4;break}return e.abrupt("return",!!t.principal.loginName);case 4:return e.next=6,t.$store.dispatch("rancher/findAll",{type:P["D"].USER,opt:{url:"/v3/users",filter:{me:!0}}});case 6:if(n=e.sent,!n||1!==n.length){e.next=9;break}return e.abrupt("return",!!n[0].username);case 9:return e.abrupt("return",!1);case 10:case"end":return e.stop()}}),e)})))()}}},L=T,N=(n("a07c"),Object(g["a"])(L,a,r,!1,null,"1fc9aab8",null));e["default"]=N.exports}}]);
//# sourceMappingURL=index.11ca60ae.js.map