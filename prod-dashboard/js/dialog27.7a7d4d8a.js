(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["dialog27"],{"262f":function(e,t,r){"use strict";r.r(t);var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("Card",{staticClass:"prompt-rotate",style:{height:"100%"},attrs:{"show-highlight-border":!1},scopedSlots:e._u([{key:"title",fn:function(){return[r("h3",[e._v(e._s(e.t("cluster.rotateCertificates.modalTitle")))])]},proxy:!0},{key:"body",fn:function(){return[e._l(e.errors,(function(e,t){return r("Banner",{key:t,attrs:{color:"error",label:e}})})),r("div",{staticClass:"options"},[r("RadioGroup",{attrs:{name:"service-mode",options:[{value:!0,label:e.t("cluster.rotateCertificates.allServices")},{value:!1,label:e.t("cluster.rotateCertificates.selectService")}]},model:{value:e.rotateAllServices,callback:function(t){e.rotateAllServices=t},expression:"rotateAllServices"}}),r("Select",{staticClass:"service-select",class:{invisible:e.rotateAllServices},attrs:{options:e.serviceOptions},model:{value:e.selectedService,callback:function(t){e.selectedService=t},expression:"selectedService"}})],1)]},proxy:!0}])},[r("div",{staticClass:"buttons",attrs:{slot:"actions"},slot:"actions"},[r("button",{staticClass:"btn role-secondary mr-20",on:{click:e.close}},[e._v(" "+e._s(e.t("generic.cancel"))+" ")]),r("AsyncButton",{attrs:{mode:"rotate",disabled:!e.rotateAllServices&&!e.selectedService},on:{click:e.rotate}})],1)])},c=[],i=r("1da1"),o=r("a34a"),a=r.n(o),n=(r("96cf"),r("e89d"),r("d4bf")),l=r("67c9"),u=r("bec1"),v=r("fa35"),d=r("c989"),f=r("de78"),p=r("4579"),b={components:{Select:d["a"],RadioGroup:v["b"],Card:n["a"],AsyncButton:l["b"],Banner:u["a"]},props:{cluster:{type:Object,default:function(){return{}}}},data:function(){return{selectedService:"",rotateAllServices:!0,errors:[]}},computed:{serviceOptions:function(){if(this.cluster.isRke2){var e=["admin","api-server","controller-manager","scheduler","cloud-controller","etcd","auth-proxy","kubelet","kube-proxy"];return this.cluster.isK3s?e.push("k3s-controller","k3s-server"):e.push("rke2-controller","rke2-server"),e.sort()}var t=this.$store.getters["rancher/schemaFor"]("rotatecertificateinput");return Object(f["get"])(t,"resourceFields.services.options")||[]},actionParams:function(){return this.rotateAllServices?{services:this.cluster.isRke2?[]:null,caCertificates:!1}:{services:this.selectedService,caCertificates:!1}}},mounted:function(){this.selectedService=this.serviceOptions[0]||""},methods:{close:function(){this.$emit("close")},rotate:function(e){var t=this;return Object(i["a"])(a.a.mark((function r(){var s,c,i,o,n;return a.a.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(s=t.actionParams,r.prev=1,!t.cluster.isRke2){r.next=9;break}return n=(null===(c=t.cluster.spec)||void 0===c||null===(i=c.rkeConfig)||void 0===i||null===(o=i.rotateCertificates)||void 0===o?void 0:o.generation)||0,Object(f["set"])(t.cluster,"spec.rkeConfig.rotateCertificates",{generation:n+1,services:t.selectedService&&!t.rotateAllServices?[t.selectedService]:[]}),r.next=7,t.cluster.save();case 7:r.next=11;break;case 9:return r.next=11,t.cluster.mgmt.doAction("rotateCertificates",s);case 11:e(!0),t.close(),r.next=19;break;case 15:r.prev=15,r.t0=r["catch"](1),t.errors=Object(p["c"])(r.t0),e(!1);case 19:case"end":return r.stop()}}),r,null,[[1,15]])})))()}}},h=b,k=(r("d469"),r("0c7c")),m=Object(k["a"])(h,s,c,!1,null,"41281ab8",null);t["default"]=m.exports},4786:function(e,t,r){},d469:function(e,t,r){"use strict";r("4786")}}]);
//# sourceMappingURL=dialog27.7a7d4d8a.js.map